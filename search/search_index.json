{"config":{"indexing":"full","lang":["en"],"min_search_length":3,"prebuild_index":false,"separator":"[\\s\\-]+"},"docs":[{"location":"","text":"\u0417\u0430\u043c\u0435\u0442\u043a\u0438 \u042d\u0442\u0438 \u0437\u0430\u043c\u0435\u0442\u043a\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u0438\u043d\u0442\u0435\u0440\u0435\u0441 \u043f\u0440\u0435\u0436\u0434\u0435 \u0432\u0441\u0435\u0433\u043e \u0434\u043b\u044f \u043c\u0435\u043d\u044f \u0441\u0430\u043c\u043e\u0433\u043e, \u043f\u0440\u043e\u0441\u0442\u043e \u0447\u0442\u043e\u0431\u044b \"\u043d\u0435 \u0437\u0430\u0431\u044b\u0442\u044c\" \u0442\u043e, \u0441 \u0447\u0435\u043c \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u0442\u044c\u0441\u044f. \u0418 \u043d\u0435 \u0442\u0440\u0430\u0442\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043e\u0431\u0445\u043e\u0434 \u043e\u0434\u043d\u0438\u0445 \u0438 \u0442\u0435\u0445 \u0436\u0435 \"\u043f\u043e\u0434\u0432\u043e\u0434\u043d\u044b\u0445 \u043a\u0430\u043c\u043d\u0435\u0439\" \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u0440\u0430\u0437. \u041f\u043e\u043a\u0430 \u0432\u0438\u0434\u0438\u0442\u0441\u044f, \u0447\u0442\u043e \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043e\u043a \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0441\u0432\u044f\u0449\u0435\u043d\u0430 \u0440\u0435\u0448\u0435\u043d\u0438\u044e \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c linux, qemu, k8s. \u041d\u043e \u0434\u0443\u043c\u0430\u044e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0438\u043c\u0438 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u044f \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u041f\u041e, \u0442\u043e \u0432\u043f\u043e\u043b\u043d\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u044e \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0435\u0439 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441 \u044d\u0442\u043e\u0439 \u0442\u0435\u043c\u043e\u0439. Qemu \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0435\u0442\u044c qemu \u0447\u0435\u0440\u0435\u0437 vpp \u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 qemu \u043c\u0430\u0448\u0438\u043d \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU Kubernetes Development","title":"\u0422\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0437\u0430\u043c\u0435\u0442\u043a\u0438"},{"location":"#_1","text":"\u042d\u0442\u0438 \u0437\u0430\u043c\u0435\u0442\u043a\u0438 \u043f\u0440\u0435\u0434\u0441\u0442\u0430\u0432\u043b\u044f\u044e\u0442 \u0438\u043d\u0442\u0435\u0440\u0435\u0441 \u043f\u0440\u0435\u0436\u0434\u0435 \u0432\u0441\u0435\u0433\u043e \u0434\u043b\u044f \u043c\u0435\u043d\u044f \u0441\u0430\u043c\u043e\u0433\u043e, \u043f\u0440\u043e\u0441\u0442\u043e \u0447\u0442\u043e\u0431\u044b \"\u043d\u0435 \u0437\u0430\u0431\u044b\u0442\u044c\" \u0442\u043e, \u0441 \u0447\u0435\u043c \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u0440\u0430\u0437\u043e\u0431\u0440\u0430\u0442\u044c\u0441\u044f. \u0418 \u043d\u0435 \u0442\u0440\u0430\u0442\u0438\u0442\u044c \u0432\u0440\u0435\u043c\u044f \u043d\u0430 \u043e\u0431\u0445\u043e\u0434 \u043e\u0434\u043d\u0438\u0445 \u0438 \u0442\u0435\u0445 \u0436\u0435 \"\u043f\u043e\u0434\u0432\u043e\u0434\u043d\u044b\u0445 \u043a\u0430\u043c\u043d\u0435\u0439\" \u043f\u043e \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u0440\u0430\u0437. \u041f\u043e\u043a\u0430 \u0432\u0438\u0434\u0438\u0442\u0441\u044f, \u0447\u0442\u043e \u0431\u043e\u043b\u044c\u0448\u0430\u044f \u0447\u0430\u0441\u0442\u044c \u0437\u0430\u043c\u0435\u0442\u043e\u043a \u0431\u0443\u0434\u0435\u0442 \u043f\u043e\u0441\u0432\u044f\u0449\u0435\u043d\u0430 \u0440\u0435\u0448\u0435\u043d\u0438\u044e \u0440\u0430\u0437\u043b\u0438\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0431\u043b\u0435\u043c \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c linux, qemu, k8s. \u041d\u043e \u0434\u0443\u043c\u0430\u044e \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u0432\u0430\u0442\u044c\u0441\u044f \u0438\u043c\u0438 \u043d\u0435 \u0431\u0443\u0434\u0435\u0442, \u043f\u043e\u0441\u043a\u043e\u043b\u044c\u043a\u0443 \u043e\u0441\u043d\u043e\u0432\u043d\u0430\u044f \u043c\u043e\u044f \u0434\u0435\u044f\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0432\u044f\u0437\u0430\u043d\u0430 \u0441 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u043e\u0439 \u041f\u041e, \u0442\u043e \u0432\u043f\u043e\u043b\u043d\u0435 \u0434\u043e\u043f\u0443\u0441\u043a\u0430\u044e \u043f\u043e\u044f\u0432\u043b\u0435\u043d\u0438\u0435 \u0441\u0442\u0430\u0442\u0435\u0439 \u0441\u0432\u044f\u0437\u0430\u043d\u043d\u044b\u0445 \u0438 \u0441 \u044d\u0442\u043e\u0439 \u0442\u0435\u043c\u043e\u0439.","title":"\u0417\u0430\u043c\u0435\u0442\u043a\u0438"},{"location":"#qemu","text":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0435\u0442\u044c qemu \u0447\u0435\u0440\u0435\u0437 vpp \u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 qemu \u043c\u0430\u0448\u0438\u043d \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU","title":"Qemu"},{"location":"#kubernetes","text":"","title":"Kubernetes"},{"location":"#development","text":"","title":"Development"},{"location":"about/","text":"\u0412\u043e\u043b\u043e\u0433\u0434\u0438\u043d \u0414\u043c\u0438\u0442\u0440\u0438\u0439 email: ds.vologdin@yandex.ru \u0427\u0435\u043c \u0437\u0430\u043d\u0438\u043c\u0430\u044e\u0441\u044c \u0421 2021 \u0433\u043e\u0434\u0430 \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u044e \u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 CloudMTS . 2.5 \u0433\u043e\u0434\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u043b PaaS \u0441\u0435\u0440\u0432\u0438\u0441 Managed Kubernetes. \u0410 \u0432 \u043a\u043e\u043d\u0446\u0435 2023 \u0433\u043e\u0434\u0430 \u043f\u0435\u0440\u0435\u0448\u0435\u043b \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 Compute. golang \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e \u0441 2020 \u0433\u043e\u0434\u0430 \u043f\u043e \u0441\u0435\u0439 \u0434\u0435\u043d\u044c. \u0412 \u043e\u0434\u043d\u043e\u043c \u0438\u0437 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043b\u0430\u0441\u044c \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0434\u043e\u0432\u043e\u043b\u044c\u043d\u043e \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0431\u044a\u0435\u043c \u0442\u0435\u043b\u0435\u043c\u0435\u0442\u0440\u0438\u0438 \u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e python \u043d\u0435 \u0445\u0432\u0430\u0442\u0438\u043b\u043e, \u043d\u0435 \u043f\u043e\u043c\u043e\u0433 \u0434\u0430\u0436\u0435 uvloop . \u0412 \u0438\u0442\u043e\u0433\u0435 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0430 go, \u0447\u0442\u043e \u0438 \u043f\u043e\u043b\u043e\u0436\u0438\u043b\u043e \u043d\u0430\u0447\u0430\u043b\u043e \u0443\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435\u043c \u043d\u043e\u0432\u044b\u043c \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0441\u0442\u0435\u043a\u043e\u043c. python \u0412 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0430 \u0441 2019 \u043f\u043e 2021 \u0433\u043e\u0434. \u0414\u0430, \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u0430\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043d\u0430\u0447\u0430\u043b\u0430\u0441\u044c \u0441 Django . \u0418 \u043c\u043d\u0435 \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0432\u0435\u0437\u043b\u043e, \u043f\u043e\u043f\u0430\u043b \u043d\u0430 \u043f\u0440\u043e\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0440\u0430\u0431\u043e\u0442\u0430\u043b \u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u043c (\u0438\u043b\u0438 \u0432\u043d\u0435\u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u043c) \u043f\u0440\u0435\u0434\u0435\u043b\u0435 \u0441\u0432\u043e\u0438\u0445 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0435\u0439. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u043b\u043e \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438. \u0423\u0437\u043a\u0438\u043c \u043c\u0435\u0441\u0442\u043e\u043c \u0431\u044b\u043b postgresql \u0438 \u0442\u043e \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u043b \u0441 \u043d\u0438\u043c \u043d\u0430\u0448\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435. \u0411\u044b\u0441\u0442\u0440\u043e \u043f\u0440\u0438\u0448\u043b\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0431\u0443\u0434\u0443\u0449\u0435\u0435 \u0437\u0430 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u0434\u0438\u0433\u043c\u0430\u043c\u0438. \u0427\u0442\u043e \u043f\u043e\u0434\u0442\u043e\u043b\u043a\u043d\u0443\u043b\u043e \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043c\u043e\u043b\u043e\u0434\u043e\u0439 \u0438 \u0434\u0435\u0440\u0437\u043a\u0438\u0439 \u0441\u0442\u0430\u0440\u0442\u0430\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0443\u0436\u0435 \u043d\u0435 \u043d\u0430\u0448\u043b\u043e\u0441\u044c \u043c\u0435\u0441\u0442\u043e \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c \u0438 ORM. \u0418\u0445 \u043a \u043c\u043e\u0435\u0439 \u0440\u0430\u0434\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u043c\u0435\u043d\u044f\u043b\u0438 \u043d\u0430 asyncio \u0438 raw sql. \u0414\u043e 2019 \u0433\u043e\u0434\u0430 \u043e\u043a\u043e\u043b\u043e 10 \u043b\u0435\u0442 python \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u0434\u043c\u0438\u043d\u0441\u043a\u043e\u0439 \u0440\u0443\u0442\u0438\u043d\u044b. k8s \u0412 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0441\u0442\u0430\u0440\u0442\u0430\u043f\u0430\u0445 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u043f\u043e\u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u0432. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u043c\u044b managed \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043e\u0442 \u0440\u0430\u0437\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432. \u0427\u0442\u043e \u043f\u043e\u0440\u043e\u0434\u0438\u043b\u043e \u0443 \u043c\u0435\u043d\u044f \u043c\u0430\u0441\u0441\u0443 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044d\u0442\u0438\u0445 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432. \u041f\u043e\u0442\u043e\u043c\u0443 \u043d\u0435 \u0441\u043c\u043e\u0433 \u043f\u0440\u043e\u0439\u0442\u0438 \u043c\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441\u0432\u043e\u0439 managed kubernetes. \u0427\u0435\u043c\u0443 \u043f\u043e\u0441\u0432\u044f\u0442\u0438\u043b 2.5 \u0433\u043e\u0434\u0430 \u0438 \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u043b \u0431\u044b \u044d\u0442\u0438\u043c \u0437\u0430\u043d\u0438\u043c\u0430\u0442\u044c\u0441\u044f \u0434\u0430\u043b\u044c\u0448\u0435. \u041e\u0434\u043d\u0430\u043a\u043e \u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u043c \u043e\u0442 \u043c\u0435\u043d\u044f \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043d \u043d\u0430 \u043d\u043e\u0432\u043e\u0435 \u0441\u043b\u043e\u0436\u043d\u043e\u0435 \u0438 \u0443\u0432\u043b\u0435\u043a\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435. Linux \u041e\u043a\u043e\u043b\u043e 12-13 \u043b\u0435\u0442 \u0437\u0430\u043d\u0438\u043c\u0430\u043b\u0441\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0430\u0440\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u043d\u0430 linux, \u0447\u0442\u043e \u043f\u0440\u0438\u0432\u0438\u043b\u043e \u043c\u043d\u0435 \u043b\u044e\u0431\u043e\u0432\u044c \u043a \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u0447\u0430\u043c.","title":"\u041e\u0431\u043e \u043c\u043d\u0435"},{"location":"about/#_1","text":"email: ds.vologdin@yandex.ru","title":"\u0412\u043e\u043b\u043e\u0433\u0434\u0438\u043d \u0414\u043c\u0438\u0442\u0440\u0438\u0439"},{"location":"about/#_2","text":"\u0421 2021 \u0433\u043e\u0434\u0430 \u0443\u0447\u0430\u0441\u0442\u0432\u0443\u044e \u0432 \u0441\u043e\u0437\u0434\u0430\u043d\u0438\u0438 \u043e\u0431\u043b\u0430\u0447\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u0430 CloudMTS . 2.5 \u0433\u043e\u0434\u0430 \u0440\u0430\u0437\u0440\u0430\u0431\u0430\u0442\u044b\u0432\u0430\u043b PaaS \u0441\u0435\u0440\u0432\u0438\u0441 Managed Kubernetes. \u0410 \u0432 \u043a\u043e\u043d\u0446\u0435 2023 \u0433\u043e\u0434\u0430 \u043f\u0435\u0440\u0435\u0448\u0435\u043b \u0432 \u043a\u043e\u043c\u0430\u043d\u0434\u0443 Compute.","title":"\u0427\u0435\u043c \u0437\u0430\u043d\u0438\u043c\u0430\u044e\u0441\u044c"},{"location":"about/#golang","text":"\u0418\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e \u0441 2020 \u0433\u043e\u0434\u0430 \u043f\u043e \u0441\u0435\u0439 \u0434\u0435\u043d\u044c. \u0412 \u043e\u0434\u043d\u043e\u043c \u0438\u0437 \u043f\u0440\u043e\u0435\u043a\u0442\u043e\u0432 \u043f\u043e\u0442\u0440\u0435\u0431\u043e\u0432\u0430\u043b\u0430\u0441\u044c \u0441\u043e\u0431\u0438\u0440\u0430\u0442\u044c \u0434\u043e\u0432\u043e\u043b\u044c\u043d\u043e \u0431\u043e\u043b\u044c\u0448\u043e\u0439 \u043e\u0431\u044a\u0435\u043c \u0442\u0435\u043b\u0435\u043c\u0435\u0442\u0440\u0438\u0438 \u0438 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u043e\u0433\u043e python \u043d\u0435 \u0445\u0432\u0430\u0442\u0438\u043b\u043e, \u043d\u0435 \u043f\u043e\u043c\u043e\u0433 \u0434\u0430\u0436\u0435 uvloop . \u0412 \u0438\u0442\u043e\u0433\u0435 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u043f\u0435\u0440\u0435\u043f\u0438\u0441\u0430\u0442\u044c \u0441\u0435\u0440\u0432\u0438\u0441 \u043d\u0430 go, \u0447\u0442\u043e \u0438 \u043f\u043e\u043b\u043e\u0436\u0438\u043b\u043e \u043d\u0430\u0447\u0430\u043b\u043e \u0443\u0432\u043b\u0435\u0447\u0435\u043d\u0438\u0435\u043c \u043d\u043e\u0432\u044b\u043c \u0442\u0435\u0445\u043d\u0438\u0447\u0435\u0441\u043a\u0438\u043c \u0441\u0442\u0435\u043a\u043e\u043c.","title":"golang"},{"location":"about/#python","text":"\u0412 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u043e\u0439 \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0430 \u0441 2019 \u043f\u043e 2021 \u0433\u043e\u0434. \u0414\u0430, \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432\u0430\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u043a\u0430 \u043d\u0430\u0447\u0430\u043b\u0430\u0441\u044c \u0441 Django . \u0418 \u043c\u043d\u0435 \u0441\u0440\u0430\u0437\u0443 \u043f\u043e\u0432\u0435\u0437\u043b\u043e, \u043f\u043e\u043f\u0430\u043b \u043d\u0430 \u043f\u0440\u043e\u0435\u043a\u0442, \u043a\u043e\u0442\u043e\u0440\u044b\u0439 \u0440\u0430\u0431\u043e\u0442\u0430\u043b \u043d\u0430 \u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u043c (\u0438\u043b\u0438 \u0432\u043d\u0435\u043e\u0447\u0435\u0440\u0435\u0434\u043d\u043e\u043c) \u043f\u0440\u0435\u0434\u0435\u043b\u0435 \u0441\u0432\u043e\u0438\u0445 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u0435\u0439. \u041d\u0435 \u0445\u0432\u0430\u0442\u0430\u043b\u043e \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438. \u0423\u0437\u043a\u0438\u043c \u043c\u0435\u0441\u0442\u043e\u043c \u0431\u044b\u043b postgresql \u0438 \u0442\u043e \u043a\u0430\u043a \u0440\u0430\u0431\u043e\u0442\u0430\u043b \u0441 \u043d\u0438\u043c \u043d\u0430\u0448\u0435 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u0435. \u0411\u044b\u0441\u0442\u0440\u043e \u043f\u0440\u0438\u0448\u043b\u043e \u043f\u043e\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u0431\u0443\u0434\u0443\u0449\u0435\u0435 \u0437\u0430 \u0430\u0441\u0438\u043d\u0445\u0440\u043e\u043d\u043d\u044b\u043c\u0438 \u043f\u0430\u0440\u0430\u0434\u0438\u0433\u043c\u0430\u043c\u0438. \u0427\u0442\u043e \u043f\u043e\u0434\u0442\u043e\u043b\u043a\u043d\u0443\u043b\u043e \u043f\u0435\u0440\u0435\u0439\u0442\u0438 \u0432 \u043c\u043e\u043b\u043e\u0434\u043e\u0439 \u0438 \u0434\u0435\u0440\u0437\u043a\u0438\u0439 \u0441\u0442\u0430\u0440\u0442\u0430\u043f, \u0432 \u043a\u043e\u0442\u043e\u0440\u043e\u043c \u0443\u0436\u0435 \u043d\u0435 \u043d\u0430\u0448\u043b\u043e\u0441\u044c \u043c\u0435\u0441\u0442\u043e \u0444\u0440\u0435\u0439\u043c\u0432\u043e\u0440\u043a\u0430\u043c \u0438 ORM. \u0418\u0445 \u043a \u043c\u043e\u0435\u0439 \u0440\u0430\u0434\u043e\u0441\u0442\u0438 \u043f\u0440\u043e\u043c\u0435\u043d\u044f\u043b\u0438 \u043d\u0430 asyncio \u0438 raw sql. \u0414\u043e 2019 \u0433\u043e\u0434\u0430 \u043e\u043a\u043e\u043b\u043e 10 \u043b\u0435\u0442 python \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b \u0434\u043b\u044f \u0430\u0432\u0442\u043e\u043c\u0430\u0442\u0438\u0437\u0430\u0446\u0438\u0438 \u0430\u0434\u043c\u0438\u043d\u0441\u043a\u043e\u0439 \u0440\u0443\u0442\u0438\u043d\u044b.","title":"python"},{"location":"about/#k8s","text":"\u0412 \u043d\u0435\u0441\u043a\u043e\u043b\u044c\u043a\u0438\u0445 \u0441\u0442\u0430\u0440\u0442\u0430\u043f\u0430\u0445 \u043f\u0440\u0438\u0448\u043b\u043e\u0441\u044c \u043f\u043e\u0443\u0447\u0430\u0441\u0442\u0432\u043e\u0432\u0430\u0442\u044c \u0432 \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 k8s \u043a\u043b\u0430\u0441\u0442\u0435\u0440\u043e\u0432. \u0418\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u043c\u044b managed \u0440\u0435\u0448\u0435\u043d\u0438\u044f \u043e\u0442 \u0440\u0430\u0437\u043d\u044b\u0445 \u043e\u0431\u043b\u0430\u0447\u043d\u044b\u0445 \u043f\u0440\u043e\u0432\u0430\u0439\u0434\u0435\u0440\u043e\u0432. \u0427\u0442\u043e \u043f\u043e\u0440\u043e\u0434\u0438\u043b\u043e \u0443 \u043c\u0435\u043d\u044f \u043c\u0430\u0441\u0441\u0443 \u0432\u043e\u043f\u0440\u043e\u0441\u043e\u0432 \u043a \u0440\u0435\u0430\u043b\u0438\u0437\u0430\u0446\u0438\u0438 \u044d\u0442\u0438\u0445 \u043f\u0440\u043e\u0434\u0443\u043a\u0442\u043e\u0432. \u041f\u043e\u0442\u043e\u043c\u0443 \u043d\u0435 \u0441\u043c\u043e\u0433 \u043f\u0440\u043e\u0439\u0442\u0438 \u043c\u0438\u043c\u043e \u043f\u0440\u0435\u0434\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0440\u0430\u0437\u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441\u0432\u043e\u0439 managed kubernetes. \u0427\u0435\u043c\u0443 \u043f\u043e\u0441\u0432\u044f\u0442\u0438\u043b 2.5 \u0433\u043e\u0434\u0430 \u0438 \u0441\u043a\u043e\u0440\u0435\u0435 \u0432\u0441\u0435\u0433\u043e \u043f\u0440\u043e\u0434\u043e\u043b\u0436\u0430\u043b \u0431\u044b \u044d\u0442\u0438\u043c \u0437\u0430\u043d\u0438\u043c\u0430\u0442\u044c\u0441\u044f \u0434\u0430\u043b\u044c\u0448\u0435. \u041e\u0434\u043d\u0430\u043a\u043e \u043f\u043e \u043d\u0435\u0437\u0430\u0432\u0438\u0441\u044f\u0449\u0438\u043c \u043e\u0442 \u043c\u0435\u043d\u044f \u043f\u0440\u0438\u0447\u0438\u043d\u0430\u043c \u0431\u044b\u043b \u043f\u0435\u0440\u0435\u0432\u0435\u0434\u0435\u043d \u043d\u0430 \u043d\u043e\u0432\u043e\u0435 \u0441\u043b\u043e\u0436\u043d\u043e\u0435 \u0438 \u0443\u0432\u043b\u0435\u043a\u0430\u0442\u0435\u043b\u044c\u043d\u043e\u0435 \u043d\u0430\u043f\u0440\u0430\u0432\u043b\u0435\u043d\u0438\u0435.","title":"k8s"},{"location":"about/#linux","text":"\u041e\u043a\u043e\u043b\u043e 12-13 \u043b\u0435\u0442 \u0437\u0430\u043d\u0438\u043c\u0430\u043b\u0441\u044f \u0430\u0434\u043c\u0438\u043d\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0435\u043c \u043f\u0430\u0440\u043a\u0430 \u0441\u0435\u0440\u0432\u0435\u0440\u043e\u0432 \u043d\u0430 linux, \u0447\u0442\u043e \u043f\u0440\u0438\u0432\u0438\u043b\u043e \u043c\u043d\u0435 \u043b\u044e\u0431\u043e\u0432\u044c \u043a \u0438\u043d\u0444\u0440\u0430\u0441\u0442\u0440\u0443\u043a\u0442\u0443\u0440\u043d\u044b\u043c \u0437\u0430\u0434\u0430\u0447\u0430\u043c.","title":"Linux"},{"location":"notes/qemu_pin_cpus/","text":"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU \u0414\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0445\u043e\u0440\u043e\u0448\u0435\u0439 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u043e\u0434\u0443\u043c\u0430\u0442\u044c \u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0438\u0445 \u0441 \u044d\u043a\u0441\u043a\u043b\u044e\u0437\u0438\u0432\u043d\u043e\u0439 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u043e\u0439 \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b. \u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430 \u0442\u043e\u043f\u043e\u043b\u043e\u0433\u0438\u044e \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b. \u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u0430 lscpu Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Address sizes: 46 bits physical, 48 bits virtual Byte Order: Little Endian CPU(s): 96 On-line CPU(s) list: 0-95 Vendor ID: GenuineIntel Model name: Intel(R) Xeon(R) Gold 6248R CPU @ 3.00GHz CPU family: 6 Model: 85 Thread(s) per core: 2 Core(s) per socket: 24 Socket(s): 2 Stepping: 7 CPU max MHz: 4000.0000 CPU min MHz: 1200.0000 BogoMIPS: 6000.00 Flags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe sysca ll nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmu lqdq dtes64 ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_time r aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single ssbd mba ibrs ibpb stibp i brs_enhanced tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc c qm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts pku ospke avx512_vnni md_clear flush_l1d arch_capabilities Virtualization features: Virtualization: VT-x Caches (sum of all): L1d: 1.5 MiB (48 instances) L1i: 1.5 MiB (48 instances) L2: 48 MiB (48 instances) L3: 71.5 MiB (2 instances) NUMA: NUMA node(s): 2 NUMA node0 CPU(s): 0-23,48-71 NUMA node1 CPU(s): 24-47,72-95 Vulnerabilities: Gather data sampling: Mitigation; Microcode Itlb multihit: KVM: Mitigation: Split huge pages L1tf: Not affected Mds: Not affected Meltdown: Not affected Mmio stale data: Mitigation; Clear CPU buffers; SMT vulnerable Retbleed: Mitigation; Enhanced IBRS Spec rstack overflow: Not affected Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp Spectre v1: Mitigation; usercopy/swapgs barriers and __user pointer sanitization Spectre v2: Mitigation; Enhanced IBRS, IBPB conditional, RSB filling, PBRSB-eIBRS SW sequence Srbds: Not affected Tsx async abort: Mitigation; TSX disabled \u0422\u0430\u043a \u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u043f\u043e\u043b\u043e\u0433\u0438\u044e lstopo --of png > host.png \u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0432\u0438\u0434\u0438\u043c, \u0447\u0442\u043e \u043d\u0430 \u043d\u0430\u0448\u0435\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 2 NUMA \u043d\u043e\u0434\u044b. \u0418 \u044d\u0442\u043e \u043d\u0430\u0434\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 qemu \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (\u0442\u0440\u0435\u0434\u043e\u0432). \u041e\u0447\u0435\u043d\u044c \u0436\u0435\u043b\u0430\u0442\u0435\u043b\u044c\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b qemu \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u043d\u0430 \u043e\u0434\u043d\u043e\u0439 NUMA \u043d\u043e\u0434\u0435 \u0438 \u0442\u0430\u043c \u0436\u0435 \u0431\u044b\u043b\u0430 \u0431\u044b \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043f\u043e\u0434 \u043d\u0438\u0445 \u043f\u0430\u043c\u044f\u0442\u044c. \u0420\u0435\u0441\u0443\u0440\u0441\u044b \u043f\u043e\u0434 \u0441\u0438\u0441\u0442\u0435\u043c\u0443 \u0422\u0430\u043a \u0436\u0435 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 CPU, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d. \u041d\u0430 \u043d\u0430\u0448\u0435\u0439 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u0432\u044b\u0434\u0435\u043b\u0438\u043c \u043f\u043e\u0434 \u043d\u0438\u0445 0,48,24,72 CPU. \u0421\u0442\u043e\u0438\u0442 \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u044d\u0442\u043e 2 \u044f\u0434\u0440\u0430 \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u0433\u0438\u043f\u0435\u0440-\u0442\u0440\u0435\u0434\u0438\u043d\u0433\u0430 . \u041f\u0430\u0440\u0430 0 \u0438 48 - \u044d\u0442\u043e \u043e\u0434\u043d\u043e \u044f\u0434\u0440\u043e \u0441 2 \u0442\u0440\u0435\u0434\u0430\u043c\u0438. \u0423 \u043f\u0430\u0440\u044b 24 \u0438 72 \u0442\u0430\u043a\u0430\u044f \u0436\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044f. \u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU \u0412\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 systemd \u0441\u043b\u0430\u0439\u0441\u0430\u0445 . A slice unit is a concept for hierarchically managing resources of a group of processes. \u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043b\u0430\u0439\u0441\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u044e cgroups \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0435. \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a\u0430\u044f \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u044f \u0441\u043b\u0430\u0439\u0441\u043e\u0432. systemd-cgls -.slice \u251c\u2500user.slice \u2502 \u2514\u2500user-1000.slice \u2502 \u251c\u2500user@1000.service \u2026 \u2502 \u2502 \u2514\u2500init.scope \u2502 \u2502 \u251c\u25002754 /lib/systemd/systemd --user \u2502 \u2502 \u2514\u25002755 (sd-pam) \u2502 \u2514\u2500session-479.scope \u2502 \u251c\u250052512 sshd: ubuntu [priv] \u2502 \u251c\u250052571 sshd: ubuntu@pts/0 \u2502 \u251c\u250052572 -bash \u2502 \u251c\u250052581 sudo -i \u2502 \u251c\u250052582 sudo -i \u2502 \u251c\u250052583 -bash \u2502 \u251c\u250052597 systemd-cgls \u2502 \u2514\u250052598 tee \u251c\u2500init.scope \u2502 \u2514\u25001 /sbin/init \u2514\u2500system.slice \u251c\u2500irqbalance.service \u2502 \u2514\u25001903 /usr/sbin/irqbalance --foreground \u251c\u2500packagekit.service \u2502 \u2514\u250050259 /usr/libexec/packagekitd \u251c\u2500systemd-networkd.service \u2502 \u2514\u25001867 /lib/systemd/systemd-networkd \u251c\u2500systemd-udevd.service \u2502 \u2514\u25001458 /lib/systemd/systemd-udevd \u251c\u2500cron.service \u2502 \u2514\u25001897 /usr/sbin/cron -f -P \u251c\u2500system-serial\\x2dgetty.slice \u2502 \u2514\u2500serial-getty@ttyS0.service \u2502 \u2514\u25002018 /sbin/agetty -o -p -- \\u --keep-baud 115200,57600,38400,9600 ttyS0\u2026 \u251c\u2500polkit.service \u2502 \u2514\u25001906 /usr/libexec/polkitd --no-debug \u251c\u2500networkd-dispatcher.service \u2502 \u2514\u25001904 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers \u251c\u2500multipathd.service \u2502 \u2514\u25001462 /sbin/multipathd -d -s \u251c\u2500ModemManager.service \u2502 \u2514\u25001969 /usr/sbin/ModemManager \u251c\u2500systemd-journald.service \u2502 \u2514\u25001416 /lib/systemd/systemd-journald \u251c\u2500unattended-upgrades.service \u2502 \u2514\u25001994 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-s\u2026 \u251c\u2500ssh.service \u2502 \u2514\u250043450 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups \u251c\u2500snapd.service \u2502 \u2514\u250042616 /usr/lib/snapd/snapd \u251c\u2500rsyslog.service \u2502 \u2514\u25003601 /usr/sbin/rsyslogd -n -iNONE \u251c\u2500upower.service \u2502 \u2514\u250012675 /usr/libexec/upowerd \u251c\u2500systemd-resolved.service \u2502 \u2514\u25001869 /lib/systemd/systemd-resolved \u251c\u2500udisks2.service \u2502 \u2514\u25001922 /usr/libexec/udisks2/udisksd \u251c\u2500dbus.service \u2502 \u2514\u25001898 @dbus-daemon --system --address=systemd: --nofork --nopidfile --syst\u2026 \u251c\u2500systemd-timesyncd.service \u2502 \u2514\u25001827 /lib/systemd/systemd-timesyncd \u251c\u2500system-getty.slice \u2502 \u2514\u2500getty@tty1.service \u2502 \u2514\u25002020 /sbin/agetty -o -p -- \\u --noclear tty1 linux \u2514\u2500systemd-logind.service \u2514\u25001914 /lib/systemd/systemd-logind \u0418 \u044d\u0442\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u0438 cgroups tree -d /sys/fs/cgroup/ /sys/fs/cgroup/ \u251c\u2500\u2500 dev-hugepages.mount \u251c\u2500\u2500 dev-mqueue.mount \u251c\u2500\u2500 init.scope \u251c\u2500\u2500 proc-sys-fs-binfmt_misc.mount \u251c\u2500\u2500 sys-fs-fuse-connections.mount \u251c\u2500\u2500 sys-kernel-config.mount \u251c\u2500\u2500 sys-kernel-debug.mount \u251c\u2500\u2500 sys-kernel-tracing.mount \u251c\u2500\u2500 system.slice \u2502 \u251c\u2500\u2500 ModemManager.service \u2502 \u251c\u2500\u2500 boot-efi.mount \u2502 \u251c\u2500\u2500 cron.service \u2502 \u251c\u2500\u2500 dbus.service \u2502 \u251c\u2500\u2500 frr.service \u2502 \u251c\u2500\u2500 irqbalance.service \u2502 \u251c\u2500\u2500 multipathd.service \u2502 \u251c\u2500\u2500 networkd-dispatcher.service \u2502 \u251c\u2500\u2500 packagekit.service \u2502 \u251c\u2500\u2500 polkit.service \u2502 \u251c\u2500\u2500 rsyslog.service \u2502 \u251c\u2500\u2500 run-qemu.mount \u2502 \u251c\u2500\u2500 snap-core20-1974.mount \u2502 \u251c\u2500\u2500 snap-core20-2105.mount \u2502 \u251c\u2500\u2500 snap-lxd-24322.mount \u2502 \u251c\u2500\u2500 snap-snapd-20290.mount \u2502 \u251c\u2500\u2500 snap-snapd-20671.mount \u2502 \u251c\u2500\u2500 snapd.service \u2502 \u251c\u2500\u2500 snapd.socket \u2502 \u251c\u2500\u2500 ssh.service \u2502 \u251c\u2500\u2500 swap.img.swap \u2502 \u251c\u2500\u2500 system-getty.slice \u2502 \u2502 \u2514\u2500\u2500 getty@tty1.service \u2502 \u251c\u2500\u2500 system-modprobe.slice \u2502 \u251c\u2500\u2500 system-serial\\x2dgetty.slice \u2502 \u2502 \u2514\u2500\u2500 serial-getty@ttyS0.service \u2502 \u251c\u2500\u2500 system-systemd\\x2dfsck.slice \u2502 \u251c\u2500\u2500 systemd-journald.service \u2502 \u251c\u2500\u2500 systemd-logind.service \u2502 \u251c\u2500\u2500 systemd-networkd.service \u2502 \u251c\u2500\u2500 systemd-resolved.service \u2502 \u251c\u2500\u2500 systemd-timesyncd.service \u2502 \u251c\u2500\u2500 systemd-udevd.service \u2502 \u251c\u2500\u2500 udisks2.service \u2502 \u251c\u2500\u2500 unattended-upgrades.service \u2502 \u251c\u2500\u2500 upower.service \u2502 \u2514\u2500\u2500 vpp.service \u2514\u2500\u2500 user.slice \u2514\u2500\u2500 user-1000.slice \u251c\u2500\u2500 session-128.scope \u251c\u2500\u2500 session-479.scope \u251c\u2500\u2500 session-7.scope \u2514\u2500\u2500 user@1000.service \u251c\u2500\u2500 app.slice \u2502 \u2514\u2500\u2500 dbus.socket \u2514\u2500\u2500 init.scope \u041a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u0441\u043b\u0430\u0439\u0441 -.slice \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u044b \u043d\u0435 \u0431\u0443\u0434\u0435\u043c. \u0412 \u043d\u0435\u043c \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 \u043d\u0435\u0442. \u0410 \u0432\u043e\u0442 \u0432 system.slice \u0438 user.slice \u043c\u044b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u043c \u043d\u0430\u0431\u043e\u0440 CPU. mkdir /etc/systemd/system/system.slice.d/ echo \"[Slice] AllowedCPUs=0,48,24,72\" > /etc/systemd/system/system.slice.d/10-CPUSet.conf mkdir /etc/systemd/system/user.slice.d/ echo \"[Slice] AllowedCPUs=0,48,24,72\" > /etc/systemd/system/user.slice.d/10-CPUSet.conf systemctl daemon-reload \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c, \u0447\u0442\u043e \u043d\u0430\u0448\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043b\u0438\u0441\u044c systemctl cat system.slice # /etc/systemd/system/system.slice.d/10-CPUSet.conf [Slice] AllowedCPUs=0,48,24,72 systemctl cat user.slice # /lib/systemd/system/user.slice # SPDX-License-Identifier: LGPL-2.1-or-later # # This file is part of systemd. # # systemd is free software; you can redistribute it and/or modify it # under the terms of the GNU Lesser General Public License as published by # the Free Software Foundation; either version 2.1 of the License, or # (at your option) any later version. [Unit] Description=User and Session Slice Documentation=man:systemd.special(7) Before=slices.target # /etc/systemd/system/user.slice.d/10-CPUSet.conf [Slice] AllowedCPUs=0,48,24,72 \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 cgroups cat /sys/fs/cgroup/system.slice/cpuset.cpus 0,24,48,72 cat /sys/fs/cgroup/user.slice/cpuset.cpus 0,24,48,72 \u0420\u0435\u0441\u0443\u0440\u0441\u044b \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u043c \u043c\u0430\u0448\u0438\u043d\u0430\u043c \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0442\u043e\u043b\u044c\u043a\u043e CPU, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 CPU \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0435. \u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435. \u041d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435 qemu \u0441\u043e\u0437\u0434\u0430\u0441\u0442 \u0431\u043e\u043b\u044c\u0448\u0435 \u0442\u0440\u0435\u0434\u043e\u0432, \u0447\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e vCPU, \u043e\u0434\u043d\u0430\u043a\u043e \u0431\u0443\u0434\u0435\u043c \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0442\u043e\u0442 \u0444\u0430\u043a\u0442 \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u043c \u041e\u0421 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0442\u0440\u0435\u0434\u044b \u043e\u0434\u043d\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \u043d\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u043d\u0430\u0431\u043e\u0440\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 CPU. \u0422\u0430\u043a \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0430\u0443\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0441 4 vCPU, \u043f\u0440\u0438\u0432\u044f\u0436\u0435\u043c \u0435\u0451 \u043a 4 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u043c CPU, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c qemu \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c 6 \u0442\u0440\u0435\u0434\u043e\u0432. \u0410\u043b\u043b\u043e\u043a\u0430\u0446\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u043d\u0443\u0436\u043d\u043e\u0439 NUMA \u043d\u043e\u0434\u0435 Qemu \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0430 \u043a\u0430\u043a\u043e\u0439 NUMA \u043d\u043e\u0434\u0435 \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u043c\u044f\u0442\u044c. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f hugetbl, \u0442\u043e \u043d\u0430\u0434\u043e \u043e\u043f\u0438\u0441\u0430\u0442\u044c memory-backend \u0442\u0430\u043a -object memory-backend-file,id=mem,size=1Gb,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind \\ -numa node,memdev=mem \\ -mem-prealloc \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u043a\u043e\u0433\u0434\u0430 hugetbl \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0443\u044e\u0442\u0441\u044f -object memory-backend-ram,size=1Gb,id=mem,host-nodes=0,policy=bind,prealloc=on \\ -numa node,memdev=mem The host-nodes option binds the memory range to a list of NUMA host nodes. The policy option sets the NUMA policy to one of the following values: - default - default host policy - preferred - prefer the given host node list for allocation - bind - restrict memory allocation to the given host node list - interleave - interleave memory allocations across the given host node list \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 hugetbl \u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043c\u043e\u0433\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c hugetbl \u043d\u0430\u0434\u043e \u0441\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044f\u0434\u0440\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u0442\u0430\u043a. cat /etc/sysctl.d/80-qemu.conf vm.nr_hugepages=10240 \u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0441\u043e\u0437\u0434\u0430\u0435\u043c 10240 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u043f\u043e 2\u041c\u0431. \u0417\u0430\u043f\u0443\u0441\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cirros . \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437 \u0438 \u0434\u0435\u043b\u0430\u0435\u043c \u0441 \u043d\u0435\u0433\u043e \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u044b wget https://download.cirros-cloud.net/0.6.2/cirros-0.6.2-x86_64-disk.img -O cirros.img qemu-img create -f qcow2 -b cirros.img -F qcow2 test-01.img 10G qemu-img create -f qcow2 -b cirros.img -F qcow2 test-02.img 10G \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0443 \u0431\u0443\u0434\u0435\u043c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f systemd-run, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442 \u043d\u0430\u043c \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0441\u043b\u0430\u0439\u0441 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 cgroup. \u0411\u0435\u0437 hugetbl \u0417\u0430\u043f\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0432 0 NUMA \u043d\u043e\u0434\u0435, \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\u0445 3, 50, 4 \u0438 51 (2 \u044f\u0434\u0440\u0430 \u0438 4 \u0442\u0440\u0435\u0434\u0430) sudo systemd-run --slice=qemu.slice --unit=vm-test-001 -p AllowedCPUs=3,50,4,51 \\ qemu-system-x86_64 \\ -name vm-test-001 \\ -machine accel=kvm:tcg \\ -smp cpus=4 \\ -m 1024m \\ -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on \\ -numa node,memdev=mem \\ -drive file=$(pwd)/test-01.img,if=virtio \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 \\ -device e1000,netdev=net0 \\ -display none \u0421 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c hugetbl \u0417\u0430\u043f\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0432 0 NUMA \u043d\u043e\u0434\u0435, \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\u0445 5, 52, 6 \u0438 53 (2 \u044f\u0434\u0440\u0430 \u0438 4 \u0442\u0440\u0435\u0434\u0430) sudo systemd-run --slice=qemu.slice --unit=vm-test-003 -p AllowedCPUs=5,52,6,53 \\ qemu-system-x86_64 \\ -name vm-test-002 \\ -machine accel=kvm:tcg \\ -smp cpus=4 \\ -m 1024m \\ -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind \\ -numa node,memdev=mem \\ -mem-prealloc \\ -drive file=$(pwd)/test-02.img,if=virtio \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 \\ -device e1000,netdev=net0 \\ -display none \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c, \u0447\u0442\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b\u0438\u0441\u044c systemctl status vm-test-001.service \u25cf vm-test-001.service - /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backend-ram,size=1024M,id=mem,host-nod> Loaded: loaded (/run/systemd/transient/vm-test-001.service; transient) Transient: yes Active: active (running) since Thu 2024-01-11 07:54:51 UTC; 8s ago Main PID: 69254 (qemu-system-x86) Tasks: 18 (limit: 629145) Memory: 198.4M CPU: 3.033s CGroup: /qemu.slice/vm-test-001.service \u2514\u250069254 /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backend-ram,size=1024M,id=mem,host-nodes=> Jan 11 07:54:51 77iaas-dev-ubuntu-03 systemd[1]: Started /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backe systemctl status vm-test-002.service \u25cf vm-test-002.service - /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,> Loaded: loaded (/run/systemd/transient/vm-test-002.service; transient) Transient: yes Active: active (running) since Thu 2024-01-11 11:01:10 UTC; 6s ago Main PID: 70150 (qemu-system-x86) Tasks: 19 (limit: 629145) Memory: 55.6M CPU: 3.118s CGroup: /qemu.slice/vm-test-002.service \u2514\u250070150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,siz> Jan 11 11:01:10 77iaas-dev-ubuntu-02 systemd[1]: Started /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m \u041b\u043e\u0433\u0438 qemu \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c journalctl -u vm-test-001.service \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u043d\u0430 \u043a\u0430\u043a\u0438\u0445 CPU \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u0430\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u0430 ps -eL -o psr,pid,spid,cmd | grep qemu-system-x86_64 | grep vm-test-001 | grep -v grep | sort 3 70099 70105 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 4 70099 70099 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70100 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70106 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70108 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 51 70099 70107 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none \u0412\u0441\u0451 \u043a\u0430\u043a \u0438 \u043e\u0436\u0438\u0434\u0430\u043b\u043e\u0441\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f 3, 4, 50 \u0438 51. \u041d\u0430 \u0432\u0442\u043e\u0440\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 ps -eL -o psr,pid,spid,cmd | grep qemu-system-x86_64 | grep vm-test-002 | grep -v grep | sort 5 70150 70161 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 6 70150 70150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 6 70150 70151 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 52 70150 70159 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 52 70150 70162 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 53 70150 70160 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none \u0422\u043e\u0436\u0435 \u0432\u0441\u0435 \u0445\u043e\u0440\u043e\u0448\u043e - 5, 6, 52 \u0438 53. \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u043d\u043e\u0432\u044b\u0439 slice \u0432 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u0438 cgroups systemd-cgls Control group /: -.slice \u251c\u2500qemu.slice \u2502 \u251c\u2500vm-test-002.service \u2502 \u2502 \u2514\u250070150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,m> \u2502 \u2514\u2500vm-test-001.service \u2502 \u2514\u250070099 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,ho cat /sys/fs/cgroup/qemu.slice/vm-test-001.service/cpuset.cpus 3-4,50-51 cat /sys/fs/cgroup/qemu.slice/vm-test-002.service/cpuset.cpus 5-6,52-53 \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u0433\u0434\u0435 \u0432\u044b\u0434\u0435\u043b\u0438\u043b\u0430\u0441\u044c \u043f\u0430\u043c\u044f\u0442\u044c \u0434\u043b\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 # \u043e\u0434\u0438\u043d \u0438\u0437 \u0442\u0440\u0435\u0434\u043e\u0432 \u043f\u0435\u0440\u0432\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 cat /proc/70107/numa_maps | grep bind 7fa3c7e00000 bind:0 anon=262144 dirty=262144 active=39847 N0=262144 kernelpagesize_kB=4 # \u043e\u0434\u0438\u043d \u0438\u0437 \u0442\u0440\u0435\u0434\u043e\u0432 \u0432\u0442\u043e\u0440\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 cat /proc/70159/numa_maps | grep bind 7fa277e00000 bind:0 file=/dev/hugepages/qemu_back_mem.mem.WQDRfi\\040(deleted) huge dirty=512 N0=512 kernelpagesize_kB=2048 \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 N0, \u0433\u043e\u0432\u043e\u0440\u0438\u0442, \u0447\u0442\u043e \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043f\u0430\u043c\u044f\u0442\u044c \u043d\u0430 NUMA \u043d\u043e\u0434\u0435 0. \u0410 \u0441\u0435\u0439\u0447\u0430\u0441 \u043c\u043e\u0436\u043d\u043e \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b systemctl stop vm-test-001.service systemctl stop vm-test-002.service","title":"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU"},{"location":"notes/qemu_pin_cpus/#cpu","text":"\u0414\u043b\u044f \u043e\u0431\u0435\u0441\u043f\u0435\u0447\u0435\u043d\u0438\u044f \u0445\u043e\u0440\u043e\u0448\u0435\u0439 \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u0438 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u043e\u0434\u0443\u043c\u0430\u0442\u044c \u043e \u0437\u0430\u043f\u0443\u0441\u043a\u0435 \u0438\u0445 \u0441 \u044d\u043a\u0441\u043a\u043b\u044e\u0437\u0438\u0432\u043d\u043e\u0439 \u043f\u0440\u0438\u0432\u044f\u0437\u043a\u043e\u0439 \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b. \u0414\u043b\u044f \u043d\u0430\u0447\u0430\u043b\u0430 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u043d\u0430 \u0442\u043e\u043f\u043e\u043b\u043e\u0433\u0438\u044e \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b.","title":"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU"},{"location":"notes/qemu_pin_cpus/#_1","text":"lscpu Architecture: x86_64 CPU op-mode(s): 32-bit, 64-bit Address sizes: 46 bits physical, 48 bits virtual Byte Order: Little Endian CPU(s): 96 On-line CPU(s) list: 0-95 Vendor ID: GenuineIntel Model name: Intel(R) Xeon(R) Gold 6248R CPU @ 3.00GHz CPU family: 6 Model: 85 Thread(s) per core: 2 Core(s) per socket: 24 Socket(s): 2 Stepping: 7 CPU max MHz: 4000.0000 CPU min MHz: 1200.0000 BogoMIPS: 6000.00 Flags: fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush dts acpi mmx fxsr sse sse2 ss ht tm pbe sysca ll nx pdpe1gb rdtscp lm constant_tsc art arch_perfmon pebs bts rep_good nopl xtopology nonstop_tsc cpuid aperfmperf pni pclmu lqdq dtes64 ds_cpl vmx smx est tm2 ssse3 sdbg fma cx16 xtpr pdcm pcid dca sse4_1 sse4_2 x2apic movbe popcnt tsc_deadline_time r aes xsave avx f16c rdrand lahf_lm abm 3dnowprefetch cpuid_fault epb cat_l3 cdp_l3 invpcid_single ssbd mba ibrs ibpb stibp i brs_enhanced tpr_shadow vnmi flexpriority ept vpid ept_ad fsgsbase tsc_adjust bmi1 avx2 smep bmi2 erms invpcid cqm mpx rdt_a avx512f avx512dq rdseed adx smap clflushopt clwb intel_pt avx512cd avx512bw avx512vl xsaveopt xsavec xgetbv1 xsaves cqm_llc c qm_occup_llc cqm_mbm_total cqm_mbm_local dtherm ida arat pln pts pku ospke avx512_vnni md_clear flush_l1d arch_capabilities Virtualization features: Virtualization: VT-x Caches (sum of all): L1d: 1.5 MiB (48 instances) L1i: 1.5 MiB (48 instances) L2: 48 MiB (48 instances) L3: 71.5 MiB (2 instances) NUMA: NUMA node(s): 2 NUMA node0 CPU(s): 0-23,48-71 NUMA node1 CPU(s): 24-47,72-95 Vulnerabilities: Gather data sampling: Mitigation; Microcode Itlb multihit: KVM: Mitigation: Split huge pages L1tf: Not affected Mds: Not affected Meltdown: Not affected Mmio stale data: Mitigation; Clear CPU buffers; SMT vulnerable Retbleed: Mitigation; Enhanced IBRS Spec rstack overflow: Not affected Spec store bypass: Mitigation; Speculative Store Bypass disabled via prctl and seccomp Spectre v1: Mitigation; usercopy/swapgs barriers and __user pointer sanitization Spectre v2: Mitigation; Enhanced IBRS, IBPB conditional, RSB filling, PBRSB-eIBRS SW sequence Srbds: Not affected Tsx async abort: Mitigation; TSX disabled \u0422\u0430\u043a \u0436\u0435 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c \u0442\u043e\u043f\u043e\u043b\u043e\u0433\u0438\u044e lstopo --of png > host.png \u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0432\u0438\u0434\u0438\u043c, \u0447\u0442\u043e \u043d\u0430 \u043d\u0430\u0448\u0435\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 2 NUMA \u043d\u043e\u0434\u044b. \u0418 \u044d\u0442\u043e \u043d\u0430\u0434\u043e \u0443\u0447\u0438\u0442\u044b\u0432\u0430\u0442\u044c \u043f\u0440\u0438 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u043d\u0438\u0438 qemu \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 (\u0442\u0440\u0435\u0434\u043e\u0432). \u041e\u0447\u0435\u043d\u044c \u0436\u0435\u043b\u0430\u0442\u0435\u043b\u044c\u043d\u043e, \u0447\u0442\u043e\u0431\u044b \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b qemu \u0440\u0430\u0431\u043e\u0442\u0430\u043b\u0438 \u043d\u0430 \u043e\u0434\u043d\u043e\u0439 NUMA \u043d\u043e\u0434\u0435 \u0438 \u0442\u0430\u043c \u0436\u0435 \u0431\u044b\u043b\u0430 \u0431\u044b \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043f\u043e\u0434 \u043d\u0438\u0445 \u043f\u0430\u043c\u044f\u0442\u044c.","title":"\u0422\u0435\u0441\u0442\u043e\u0432\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u0430"},{"location":"notes/qemu_pin_cpus/#_2","text":"\u0422\u0430\u043a \u0436\u0435 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u043f\u0440\u043e\u0447\u0438\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u0441\u0438\u0441\u0442\u0435\u043c\u044b \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 CPU, \u043f\u0440\u0435\u0434\u043d\u0430\u0437\u043d\u0430\u0447\u0435\u043d\u043d\u044b\u0435 \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d. \u041d\u0430 \u043d\u0430\u0448\u0435\u0439 \u0442\u0435\u0441\u0442\u043e\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 \u0432\u044b\u0434\u0435\u043b\u0438\u043c \u043f\u043e\u0434 \u043d\u0438\u0445 0,48,24,72 CPU. \u0421\u0442\u043e\u0438\u0442 \u043e\u0431\u0440\u0430\u0442\u0438\u0442\u044c \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u044d\u0442\u043e 2 \u044f\u0434\u0440\u0430 \u0441 \u0443\u0447\u0435\u0442\u043e\u043c \u0433\u0438\u043f\u0435\u0440-\u0442\u0440\u0435\u0434\u0438\u043d\u0433\u0430 . \u041f\u0430\u0440\u0430 0 \u0438 48 - \u044d\u0442\u043e \u043e\u0434\u043d\u043e \u044f\u0434\u0440\u043e \u0441 2 \u0442\u0440\u0435\u0434\u0430\u043c\u0438. \u0423 \u043f\u0430\u0440\u044b 24 \u0438 72 \u0442\u0430\u043a\u0430\u044f \u0436\u0435 \u0438\u0441\u0442\u043e\u0440\u0438\u044f.","title":"\u0420\u0435\u0441\u0443\u0440\u0441\u044b \u043f\u043e\u0434 \u0441\u0438\u0441\u0442\u0435\u043c\u0443"},{"location":"notes/qemu_pin_cpus/#cpu_1","text":"\u0412\u0441\u0435 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u044b \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u044e\u0442\u0441\u044f \u0432 \u0440\u0430\u043c\u043a\u0430\u0445 systemd \u0441\u043b\u0430\u0439\u0441\u0430\u0445 . A slice unit is a concept for hierarchically managing resources of a group of processes. \u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0441\u043b\u0430\u0439\u0441\u044b \u043e\u043f\u0440\u0435\u0434\u0435\u043b\u044f\u044e\u0442 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u044e cgroups \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0435. \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u043a\u0430\u043a\u0430\u044f \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u044f \u0441\u043b\u0430\u0439\u0441\u043e\u0432. systemd-cgls -.slice \u251c\u2500user.slice \u2502 \u2514\u2500user-1000.slice \u2502 \u251c\u2500user@1000.service \u2026 \u2502 \u2502 \u2514\u2500init.scope \u2502 \u2502 \u251c\u25002754 /lib/systemd/systemd --user \u2502 \u2502 \u2514\u25002755 (sd-pam) \u2502 \u2514\u2500session-479.scope \u2502 \u251c\u250052512 sshd: ubuntu [priv] \u2502 \u251c\u250052571 sshd: ubuntu@pts/0 \u2502 \u251c\u250052572 -bash \u2502 \u251c\u250052581 sudo -i \u2502 \u251c\u250052582 sudo -i \u2502 \u251c\u250052583 -bash \u2502 \u251c\u250052597 systemd-cgls \u2502 \u2514\u250052598 tee \u251c\u2500init.scope \u2502 \u2514\u25001 /sbin/init \u2514\u2500system.slice \u251c\u2500irqbalance.service \u2502 \u2514\u25001903 /usr/sbin/irqbalance --foreground \u251c\u2500packagekit.service \u2502 \u2514\u250050259 /usr/libexec/packagekitd \u251c\u2500systemd-networkd.service \u2502 \u2514\u25001867 /lib/systemd/systemd-networkd \u251c\u2500systemd-udevd.service \u2502 \u2514\u25001458 /lib/systemd/systemd-udevd \u251c\u2500cron.service \u2502 \u2514\u25001897 /usr/sbin/cron -f -P \u251c\u2500system-serial\\x2dgetty.slice \u2502 \u2514\u2500serial-getty@ttyS0.service \u2502 \u2514\u25002018 /sbin/agetty -o -p -- \\u --keep-baud 115200,57600,38400,9600 ttyS0\u2026 \u251c\u2500polkit.service \u2502 \u2514\u25001906 /usr/libexec/polkitd --no-debug \u251c\u2500networkd-dispatcher.service \u2502 \u2514\u25001904 /usr/bin/python3 /usr/bin/networkd-dispatcher --run-startup-triggers \u251c\u2500multipathd.service \u2502 \u2514\u25001462 /sbin/multipathd -d -s \u251c\u2500ModemManager.service \u2502 \u2514\u25001969 /usr/sbin/ModemManager \u251c\u2500systemd-journald.service \u2502 \u2514\u25001416 /lib/systemd/systemd-journald \u251c\u2500unattended-upgrades.service \u2502 \u2514\u25001994 /usr/bin/python3 /usr/share/unattended-upgrades/unattended-upgrade-s\u2026 \u251c\u2500ssh.service \u2502 \u2514\u250043450 sshd: /usr/sbin/sshd -D [listener] 0 of 10-100 startups \u251c\u2500snapd.service \u2502 \u2514\u250042616 /usr/lib/snapd/snapd \u251c\u2500rsyslog.service \u2502 \u2514\u25003601 /usr/sbin/rsyslogd -n -iNONE \u251c\u2500upower.service \u2502 \u2514\u250012675 /usr/libexec/upowerd \u251c\u2500systemd-resolved.service \u2502 \u2514\u25001869 /lib/systemd/systemd-resolved \u251c\u2500udisks2.service \u2502 \u2514\u25001922 /usr/libexec/udisks2/udisksd \u251c\u2500dbus.service \u2502 \u2514\u25001898 @dbus-daemon --system --address=systemd: --nofork --nopidfile --syst\u2026 \u251c\u2500systemd-timesyncd.service \u2502 \u2514\u25001827 /lib/systemd/systemd-timesyncd \u251c\u2500system-getty.slice \u2502 \u2514\u2500getty@tty1.service \u2502 \u2514\u25002020 /sbin/agetty -o -p -- \\u --noclear tty1 linux \u2514\u2500systemd-logind.service \u2514\u25001914 /lib/systemd/systemd-logind \u0418 \u044d\u0442\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0430 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0443\u0435\u0442 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u0438 cgroups tree -d /sys/fs/cgroup/ /sys/fs/cgroup/ \u251c\u2500\u2500 dev-hugepages.mount \u251c\u2500\u2500 dev-mqueue.mount \u251c\u2500\u2500 init.scope \u251c\u2500\u2500 proc-sys-fs-binfmt_misc.mount \u251c\u2500\u2500 sys-fs-fuse-connections.mount \u251c\u2500\u2500 sys-kernel-config.mount \u251c\u2500\u2500 sys-kernel-debug.mount \u251c\u2500\u2500 sys-kernel-tracing.mount \u251c\u2500\u2500 system.slice \u2502 \u251c\u2500\u2500 ModemManager.service \u2502 \u251c\u2500\u2500 boot-efi.mount \u2502 \u251c\u2500\u2500 cron.service \u2502 \u251c\u2500\u2500 dbus.service \u2502 \u251c\u2500\u2500 frr.service \u2502 \u251c\u2500\u2500 irqbalance.service \u2502 \u251c\u2500\u2500 multipathd.service \u2502 \u251c\u2500\u2500 networkd-dispatcher.service \u2502 \u251c\u2500\u2500 packagekit.service \u2502 \u251c\u2500\u2500 polkit.service \u2502 \u251c\u2500\u2500 rsyslog.service \u2502 \u251c\u2500\u2500 run-qemu.mount \u2502 \u251c\u2500\u2500 snap-core20-1974.mount \u2502 \u251c\u2500\u2500 snap-core20-2105.mount \u2502 \u251c\u2500\u2500 snap-lxd-24322.mount \u2502 \u251c\u2500\u2500 snap-snapd-20290.mount \u2502 \u251c\u2500\u2500 snap-snapd-20671.mount \u2502 \u251c\u2500\u2500 snapd.service \u2502 \u251c\u2500\u2500 snapd.socket \u2502 \u251c\u2500\u2500 ssh.service \u2502 \u251c\u2500\u2500 swap.img.swap \u2502 \u251c\u2500\u2500 system-getty.slice \u2502 \u2502 \u2514\u2500\u2500 getty@tty1.service \u2502 \u251c\u2500\u2500 system-modprobe.slice \u2502 \u251c\u2500\u2500 system-serial\\x2dgetty.slice \u2502 \u2502 \u2514\u2500\u2500 serial-getty@ttyS0.service \u2502 \u251c\u2500\u2500 system-systemd\\x2dfsck.slice \u2502 \u251c\u2500\u2500 systemd-journald.service \u2502 \u251c\u2500\u2500 systemd-logind.service \u2502 \u251c\u2500\u2500 systemd-networkd.service \u2502 \u251c\u2500\u2500 systemd-resolved.service \u2502 \u251c\u2500\u2500 systemd-timesyncd.service \u2502 \u251c\u2500\u2500 systemd-udevd.service \u2502 \u251c\u2500\u2500 udisks2.service \u2502 \u251c\u2500\u2500 unattended-upgrades.service \u2502 \u251c\u2500\u2500 upower.service \u2502 \u2514\u2500\u2500 vpp.service \u2514\u2500\u2500 user.slice \u2514\u2500\u2500 user-1000.slice \u251c\u2500\u2500 session-128.scope \u251c\u2500\u2500 session-479.scope \u251c\u2500\u2500 session-7.scope \u2514\u2500\u2500 user@1000.service \u251c\u2500\u2500 app.slice \u2502 \u2514\u2500\u2500 dbus.socket \u2514\u2500\u2500 init.scope \u041a\u043e\u0440\u043d\u0435\u0432\u043e\u0439 \u0441\u043b\u0430\u0439\u0441 -.slice \u043c\u043e\u0434\u0438\u0444\u0438\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043c\u044b \u043d\u0435 \u0431\u0443\u0434\u0435\u043c. \u0412 \u043d\u0435\u043c \u043d\u0438\u043a\u0430\u043a\u0438\u0445 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u0438\u0439 \u043d\u0435\u0442. \u0410 \u0432\u043e\u0442 \u0432 system.slice \u0438 user.slice \u043c\u044b \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0438\u043c \u043d\u0430\u0431\u043e\u0440 CPU. mkdir /etc/systemd/system/system.slice.d/ echo \"[Slice] AllowedCPUs=0,48,24,72\" > /etc/systemd/system/system.slice.d/10-CPUSet.conf mkdir /etc/systemd/system/user.slice.d/ echo \"[Slice] AllowedCPUs=0,48,24,72\" > /etc/systemd/system/user.slice.d/10-CPUSet.conf systemctl daemon-reload \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c, \u0447\u0442\u043e \u043d\u0430\u0448\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043b\u0438\u0441\u044c systemctl cat system.slice # /etc/systemd/system/system.slice.d/10-CPUSet.conf [Slice] AllowedCPUs=0,48,24,72 systemctl cat user.slice # /lib/systemd/system/user.slice # SPDX-License-Identifier: LGPL-2.1-or-later # # This file is part of systemd. # # systemd is free software; you can redistribute it and/or modify it # under the terms of the GNU Lesser General Public License as published by # the Free Software Foundation; either version 2.1 of the License, or # (at your option) any later version. [Unit] Description=User and Session Slice Documentation=man:systemd.special(7) Before=slices.target # /etc/systemd/system/user.slice.d/10-CPUSet.conf [Slice] AllowedCPUs=0,48,24,72 \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 cgroups cat /sys/fs/cgroup/system.slice/cpuset.cpus 0,24,48,72 cat /sys/fs/cgroup/user.slice/cpuset.cpus 0,24,48,72","title":"\u041f\u0440\u0438\u0432\u044f\u0437\u043a\u0430 \u0441\u0438\u0441\u0442\u0435\u043c\u043d\u044b\u0445 \u0440\u0435\u0441\u0443\u0440\u0441\u043e\u0432 \u043a \u043a\u043e\u043d\u043a\u0440\u0435\u0442\u043d\u044b\u043c CPU"},{"location":"notes/qemu_pin_cpus/#_3","text":"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c\u0441\u043a\u0438\u043c \u043c\u0430\u0448\u0438\u043d\u0430\u043c \u043c\u044b \u0431\u0443\u0434\u0435\u043c \u043f\u0440\u0435\u0434\u043e\u0441\u0442\u0430\u0432\u043b\u044f\u0442\u044c \u0441\u0442\u043e\u043b\u044c\u043a\u043e CPU, \u0441\u043a\u043e\u043b\u044c\u043a\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 CPU \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044f \u043d\u0430 \u043c\u0430\u0448\u0438\u043d\u0435. \u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435. \u041d\u0430 \u0441\u0430\u043c\u043e\u043c \u0434\u0435\u043b\u0435 qemu \u0441\u043e\u0437\u0434\u0430\u0441\u0442 \u0431\u043e\u043b\u044c\u0448\u0435 \u0442\u0440\u0435\u0434\u043e\u0432, \u0447\u0435\u043c \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u043e vCPU, \u043e\u0434\u043d\u0430\u043a\u043e \u0431\u0443\u0434\u0435\u043c \u0438\u0433\u043d\u043e\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044d\u0442\u043e\u0442 \u0444\u0430\u043a\u0442 \u0438 \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u043c \u041e\u0421 \u043f\u043b\u0430\u043d\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u0432\u0441\u0435 \u0442\u0440\u0435\u0434\u044b \u043e\u0434\u043d\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b \u043d\u0430 \u043e\u0433\u0440\u0430\u043d\u0438\u0447\u0435\u043d\u043d\u043e\u043c \u043d\u0430\u0431\u043e\u0440\u0435 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u0445 CPU. \u0422\u0430\u043a \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u0441\u043e\u0437\u0434\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0430\u0443\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0441 4 vCPU, \u043f\u0440\u0438\u0432\u044f\u0436\u0435\u043c \u0435\u0451 \u043a 4 \u0444\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0438\u043c CPU, \u043f\u0440\u0438 \u044d\u0442\u043e\u043c qemu \u043c\u043e\u0436\u0435\u0442 \u0441\u043e\u0437\u0434\u0430\u0442\u044c 6 \u0442\u0440\u0435\u0434\u043e\u0432.","title":"\u0420\u0435\u0441\u0443\u0440\u0441\u044b \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d"},{"location":"notes/qemu_pin_cpus/#numa","text":"Qemu \u043f\u043e\u0437\u0432\u043e\u043b\u044f\u0435\u0442 \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043d\u0430 \u043a\u0430\u043a\u043e\u0439 NUMA \u043d\u043e\u0434\u0435 \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0430\u043c\u044f\u0442\u044c. \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u0435\u0441\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f hugetbl, \u0442\u043e \u043d\u0430\u0434\u043e \u043e\u043f\u0438\u0441\u0430\u0442\u044c memory-backend \u0442\u0430\u043a -object memory-backend-file,id=mem,size=1Gb,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind \\ -numa node,memdev=mem \\ -mem-prealloc \u0412 \u0441\u043b\u0443\u0447\u0430\u0435, \u043a\u043e\u0433\u0434\u0430 hugetbl \u043d\u0435 \u0438\u0441\u043f\u043e\u043b\u044c\u0443\u044e\u0442\u0441\u044f -object memory-backend-ram,size=1Gb,id=mem,host-nodes=0,policy=bind,prealloc=on \\ -numa node,memdev=mem The host-nodes option binds the memory range to a list of NUMA host nodes. The policy option sets the NUMA policy to one of the following values: - default - default host policy - preferred - prefer the given host node list for allocation - bind - restrict memory allocation to the given host node list - interleave - interleave memory allocations across the given host node list","title":"\u0410\u043b\u043b\u043e\u043a\u0430\u0446\u0438\u044f \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u043d\u0443\u0436\u043d\u043e\u0439 NUMA \u043d\u043e\u0434\u0435"},{"location":"notes/qemu_pin_cpus/#hugetbl","text":"\u0414\u043b\u044f \u0442\u043e\u0433\u043e \u0447\u0442\u043e\u0431\u044b \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043c\u043e\u0433\u043b\u0438 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c hugetbl \u043d\u0430\u0434\u043e \u0441\u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u044f\u0434\u0440\u043e \u043f\u0440\u0438\u043c\u0435\u0440\u043d\u043e \u0442\u0430\u043a. cat /etc/sysctl.d/80-qemu.conf vm.nr_hugepages=10240 \u0417\u0434\u0435\u0441\u044c \u043c\u044b \u0441\u043e\u0437\u0434\u0430\u0435\u043c 10240 \u0441\u0442\u0440\u0430\u043d\u0438\u0446 \u043f\u043e 2\u041c\u0431.","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 hugetbl"},{"location":"notes/qemu_pin_cpus/#_4","text":"\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 \u0431\u0443\u0434\u0435\u043c \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c cirros . \u0421\u043a\u0430\u0447\u0438\u0432\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437 \u0438 \u0434\u0435\u043b\u0430\u0435\u043c \u0441 \u043d\u0435\u0433\u043e \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u044b wget https://download.cirros-cloud.net/0.6.2/cirros-0.6.2-x86_64-disk.img -O cirros.img qemu-img create -f qcow2 -b cirros.img -F qcow2 test-01.img 10G qemu-img create -f qcow2 -b cirros.img -F qcow2 test-02.img 10G \u0417\u0430\u043f\u0443\u0441\u043a\u0430\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0443 \u0431\u0443\u0434\u0435\u043c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f systemd-run, \u0447\u0442\u043e \u043f\u043e\u0437\u0432\u043e\u043b\u0438\u0442 \u043d\u0430\u043c \u0443\u043a\u0430\u0437\u0430\u0442\u044c \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0439 \u0441\u043b\u0430\u0439\u0441 \u0438 \u043f\u0435\u0440\u0435\u0434\u0430\u0442\u044c \u0434\u043e\u043f\u043e\u043b\u043d\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 cgroup.","title":"\u0417\u0430\u043f\u0443\u0441\u043a \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u044b"},{"location":"notes/qemu_pin_cpus/#hugetbl_1","text":"\u0417\u0430\u043f\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0432 0 NUMA \u043d\u043e\u0434\u0435, \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\u0445 3, 50, 4 \u0438 51 (2 \u044f\u0434\u0440\u0430 \u0438 4 \u0442\u0440\u0435\u0434\u0430) sudo systemd-run --slice=qemu.slice --unit=vm-test-001 -p AllowedCPUs=3,50,4,51 \\ qemu-system-x86_64 \\ -name vm-test-001 \\ -machine accel=kvm:tcg \\ -smp cpus=4 \\ -m 1024m \\ -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on \\ -numa node,memdev=mem \\ -drive file=$(pwd)/test-01.img,if=virtio \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 \\ -device e1000,netdev=net0 \\ -display none","title":"\u0411\u0435\u0437 hugetbl"},{"location":"notes/qemu_pin_cpus/#hugetbl_2","text":"\u0417\u0430\u043f\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u0432 0 NUMA \u043d\u043e\u0434\u0435, \u043d\u0430 \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0440\u0430\u0445 5, 52, 6 \u0438 53 (2 \u044f\u0434\u0440\u0430 \u0438 4 \u0442\u0440\u0435\u0434\u0430) sudo systemd-run --slice=qemu.slice --unit=vm-test-003 -p AllowedCPUs=5,52,6,53 \\ qemu-system-x86_64 \\ -name vm-test-002 \\ -machine accel=kvm:tcg \\ -smp cpus=4 \\ -m 1024m \\ -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind \\ -numa node,memdev=mem \\ -mem-prealloc \\ -drive file=$(pwd)/test-02.img,if=virtio \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 \\ -device e1000,netdev=net0 \\ -display none \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c, \u0447\u0442\u043e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u0437\u0430\u043f\u0443\u0441\u0442\u0438\u043b\u0438\u0441\u044c systemctl status vm-test-001.service \u25cf vm-test-001.service - /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backend-ram,size=1024M,id=mem,host-nod> Loaded: loaded (/run/systemd/transient/vm-test-001.service; transient) Transient: yes Active: active (running) since Thu 2024-01-11 07:54:51 UTC; 8s ago Main PID: 69254 (qemu-system-x86) Tasks: 18 (limit: 629145) Memory: 198.4M CPU: 3.033s CGroup: /qemu.slice/vm-test-001.service \u2514\u250069254 /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backend-ram,size=1024M,id=mem,host-nodes=> Jan 11 07:54:51 77iaas-dev-ubuntu-03 systemd[1]: Started /usr/bin/qemu-system-x86_64 -machine accel=kvm:tcg -smp cpus=4 -m 1024M -object memory-backe systemctl status vm-test-002.service \u25cf vm-test-002.service - /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,> Loaded: loaded (/run/systemd/transient/vm-test-002.service; transient) Transient: yes Active: active (running) since Thu 2024-01-11 11:01:10 UTC; 6s ago Main PID: 70150 (qemu-system-x86) Tasks: 19 (limit: 629145) Memory: 55.6M CPU: 3.118s CGroup: /qemu.slice/vm-test-002.service \u2514\u250070150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,siz> Jan 11 11:01:10 77iaas-dev-ubuntu-02 systemd[1]: Started /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m \u041b\u043e\u0433\u0438 qemu \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u043c\u043e\u0436\u043d\u043e \u043f\u043e\u0441\u043c\u043e\u0442\u0440\u0435\u0442\u044c journalctl -u vm-test-001.service \u041f\u0440\u043e\u0432\u0435\u0440\u0438\u043c \u043d\u0430 \u043a\u0430\u043a\u0438\u0445 CPU \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442 \u043f\u0435\u0440\u0432\u0430\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0430\u044f \u043c\u0430\u0448\u0438\u043d\u0430 ps -eL -o psr,pid,spid,cmd | grep qemu-system-x86_64 | grep vm-test-001 | grep -v grep | sort 3 70099 70105 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 4 70099 70099 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70100 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70106 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 50 70099 70108 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none 51 70099 70107 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,host-nodes=0,policy=bind,prealloc=on -numa node,memdev=mem -drive file=/home/ubuntu/test-01.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10022-:22 -device e1000,netdev=net0 -display none \u0412\u0441\u0451 \u043a\u0430\u043a \u0438 \u043e\u0436\u0438\u0434\u0430\u043b\u043e\u0441\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044e\u0442\u0441\u044f 3, 4, 50 \u0438 51. \u041d\u0430 \u0432\u0442\u043e\u0440\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 ps -eL -o psr,pid,spid,cmd | grep qemu-system-x86_64 | grep vm-test-002 | grep -v grep | sort 5 70150 70161 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 6 70150 70150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 6 70150 70151 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 52 70150 70159 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 52 70150 70162 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none 53 70150 70160 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,mem-path=/dev/hugepages,share=on,host-nodes=0,policy=bind -numa node,memdev=mem -mem-prealloc -drive file=/home/ubuntu/test-02.img,if=virtio -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:10023-:22 -device e1000,netdev=net0 -display none \u0422\u043e\u0436\u0435 \u0432\u0441\u0435 \u0445\u043e\u0440\u043e\u0448\u043e - 5, 6, 52 \u0438 53. \u041f\u0440\u043e\u0432\u0435\u0440\u044f\u0435\u043c, \u0447\u0442\u043e \u043f\u043e\u044f\u0432\u0438\u043b\u0441\u044f \u043d\u043e\u0432\u044b\u0439 slice \u0432 \u0438\u0435\u0440\u0430\u0440\u0445\u0438\u0438 cgroups systemd-cgls Control group /: -.slice \u251c\u2500qemu.slice \u2502 \u251c\u2500vm-test-002.service \u2502 \u2502 \u2514\u250070150 /usr/bin/qemu-system-x86_64 -name vm-test-002 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-file,id=mem,size=1024m,m> \u2502 \u2514\u2500vm-test-001.service \u2502 \u2514\u250070099 /usr/bin/qemu-system-x86_64 -name vm-test-001 -machine accel=kvm:tcg -smp cpus=4 -m 1024m -object memory-backend-ram,size=1024m,id=mem,ho cat /sys/fs/cgroup/qemu.slice/vm-test-001.service/cpuset.cpus 3-4,50-51 cat /sys/fs/cgroup/qemu.slice/vm-test-002.service/cpuset.cpus 5-6,52-53 \u041f\u043e\u0441\u043c\u043e\u0442\u0440\u0438\u043c, \u0433\u0434\u0435 \u0432\u044b\u0434\u0435\u043b\u0438\u043b\u0430\u0441\u044c \u043f\u0430\u043c\u044f\u0442\u044c \u0434\u043b\u044f \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u043e\u0432 # \u043e\u0434\u0438\u043d \u0438\u0437 \u0442\u0440\u0435\u0434\u043e\u0432 \u043f\u0435\u0440\u0432\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 cat /proc/70107/numa_maps | grep bind 7fa3c7e00000 bind:0 anon=262144 dirty=262144 active=39847 N0=262144 kernelpagesize_kB=4 # \u043e\u0434\u0438\u043d \u0438\u0437 \u0442\u0440\u0435\u0434\u043e\u0432 \u0432\u0442\u043e\u0440\u043e\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 cat /proc/70159/numa_maps | grep bind 7fa277e00000 bind:0 file=/dev/hugepages/qemu_back_mem.mem.WQDRfi\\040(deleted) huge dirty=512 N0=512 kernelpagesize_kB=2048 \u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440 N0, \u0433\u043e\u0432\u043e\u0440\u0438\u0442, \u0447\u0442\u043e \u0430\u043b\u043b\u043e\u0446\u0438\u0440\u043e\u0432\u0430\u043d\u0430 \u043f\u0430\u043c\u044f\u0442\u044c \u043d\u0430 NUMA \u043d\u043e\u0434\u0435 0. \u0410 \u0441\u0435\u0439\u0447\u0430\u0441 \u043c\u043e\u0436\u043d\u043e \u043e\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b systemctl stop vm-test-001.service systemctl stop vm-test-002.service","title":"\u0421 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u0435\u043c hugetbl"},{"location":"notes/qemu_vpp/","text":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0435\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d\u044b \u0447\u0435\u0440\u0435\u0437 VPP \u0417\u0430\u0434\u0430\u0447\u0430 \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d qemu \u0432 \u043e\u0434\u043d\u0443 L2 \u0441\u0435\u0442\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \"vhost-user\" . \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u043e \u044d\u0442\u043e\u0439 \u0441\u0445\u0435\u043c\u044b \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438\u0437 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442\u044c \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438\u0445 \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0441\u0442\u0435\u043a \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u041e\u0421. \u041a\u0430\u043a \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e, \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430 linux \u043d\u0435 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u0430, \u043a \u0442\u043e\u043c\u0443 \u0436\u0435 \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0437 user \u0432 kernel space \u043d\u0435 \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u043e\u0442 \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e. \u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0430\u0431\u043e\u0442\u044b \u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0441\u0442\u0435\u043d\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f ubuntu 22.04, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u043a\u0435\u0442\u044b qemu-system-x86 genisoimage curl \u0422\u0430\u043a \u0436\u0435 \u043d\u0430\u043c \u043d\u0430\u0434\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c VPP . curl -s https://packagecloud.io/install/repositories/fdio/release/script.deb.sh | sudo bash apt-get update apt-get install vpp vpp-plugin-core vpp-plugin-dpdk \u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435 : \u041d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u044e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c VPP \u043d\u0430 \u0441\u0432\u043e\u044e \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443. \u041f\u043e\u0441\u043b\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0443 \u043c\u0435\u043d\u044f \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0430\u0434\u0430\u043b\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438\u0437 snap \u043f\u0430\u043a\u0435\u0442\u043e\u0432. Coredump \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u043b \u043e\u0448\u0438\u0431\u043a\u0443 \u0432 \u043d\u0435\u0434\u0440\u0430\u0445 libc, \u0445\u043e\u0442\u044f VPP \u0435\u0433\u043e \u0432\u0435\u0440\u0441\u0438\u044e \u043d\u0435 \u043c\u0435\u043d\u044f\u043b\u043e. \u041a\u0430\u043a \u0431\u044b\u043b\u043e \u0442\u043e \u043d\u0438 \u0431\u044b\u043b\u043e, \u043a\u0443\u0434\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u0435\u0435 \u043f\u043e\u0434\u043e\u0431\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u044b \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0442\u0435\u043d\u0434\u0430\u0445. \u0414\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 vpp \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u044e\u0442 \u0441\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0432 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e /var/log/vpp/ , \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0449\u0438\u043a \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043d\u0435 \u0441\u043e\u0437\u0434\u0430\u0435\u0442. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u044d\u0442\u043e \u043f\u043e\u0447\u0438\u043d\u0438\u0442\u044c mkdir /var/log/vpp/ systemctl restart vpp \u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u043c \u0441\u0435\u0442\u044c \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0412\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0441\u044f \u0441\u0430\u043c\u043e\u0439 \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0441\u0445\u0435\u043c\u043e\u0439 - \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0432 \u0431\u0440\u0438\u0434\u0436. \u042d\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043f\u0440\u043e\u0441\u0442\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435, \u0435\u0441\u0442\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0441\u0445\u0435\u043c\u0430 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u043c\u0438\u0440\u0435 \u0441\u0438\u043b\u044c\u043d\u043e \u0441\u043b\u043e\u0436\u043d\u0435\u0435. \u041d\u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u043c \u044d\u0442\u043e\u0439 \u0441\u0442\u0430\u0442\u044c\u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f. vppctl create vhost-user socket /var/run/vpp/01.sock server vppctl create vhost-user socket /var/run/vpp/02.sock server \u0423 \u043d\u0430\u0441 \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c 2 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 VirtualEthernet0/0/0 \u0438 VirtualEthernet0/0/1 . \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u043c \u0438\u0445 \u0432 \u0431\u0440\u0438\u0434\u0436 vppctl set interface l2 bridge VirtualEthernet0/0/0 1 vppctl set interface l2 bridge VirtualEthernet0/0/1 1 \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b : \u043c\u0430\u043a \u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u043c \u0441\u0435\u0442\u0435\u0432\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 \u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442. \u041a\u0430\u0436\u0435\u0442\u0441\u044f \u044d\u0442\u043e \u043d\u0435 \u0444\u0438\u0447\u0430. \u0412 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0430\u0434\u043e \u043f\u043e\u0432\u0435\u0441\u0438\u0442\u044c \u043d\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043c\u0430\u043a \u0430\u0434\u0440\u0435\u0441 \u0438\u0437 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 (\u0438\u043b\u0438 \u043d\u0430\u043e\u0431\u043e\u0440\u043e\u0442). \u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435 vhost-user \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f hugetbl \u0438 shared memory. VPP \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0445\u043e\u0434\u0438\u0442\u044c \u0432 \u043f\u0430\u043c\u044f\u0442\u044c \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421. VPP \u043f\u0440\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435 \u0437\u0430\u0434\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u044f\u0434\u0440\u0430, \u043d\u0430 \u043d\u0438\u0445 \u043d\u0430\u0434\u043e \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u0437\u0433\u043b\u044f\u043d\u0443\u0442\u044c \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0442\u0430\u043a cat /etc/sysctl.d/80-vpp.conf # Number of 2MB hugepages desired vm.nr_hugepages=10240 # Must be greater than or equal to (2 * vm.nr_hugepages). vm.max_map_count=20480 # All groups allowed to access hugepages vm.hugetlb_shm_group=0 # Shared Memory Max must be greater or equal to the total size of hugepages. # For 2MB pages, TotalHugepageSize = vm.nr_hugepages * 2 * 1024 * 1024 # If the existing kernel.shmmax setting (cat /proc/sys/kernel/shmmax) # is greater than the calculated TotalHugepageSize then set this parameter # to current shmmax value. kernel.shmmax=21474836480 \u043f\u043e\u0441\u043b\u0435 \u0447\u0435\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u044d\u0442\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 sysctl -p /etc/sysctl.d/80-vpp.conf vm.nr_hugepages = 10240 vm.max_map_count = 20480 vm.hugetlb_shm_group = 0 kernel.shmmax = 21474836480 \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437\u044b cloud-init \u0412 \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b\u044b \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 cloud-init. # \u0441\u043e\u0437\u0434\u0430\u0435\u043c ssh \u043a\u043b\u044e\u0447\u0438 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 ssh-keygen -t ed25519 -C \"test@compute\" # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b\u044b \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 cloud-init mkdir cloud-init touch cloud-init/meta-data touch cloud-init/network-config echo \"#cloud-config user: test password: test chpasswd: expire: False ssh_pwauth: True ssh_authorized_keys: - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC2mkI/No5xj3fFcfvq/y3b84p8nODFbQf5sETNHwa8W test@compute \" > cloud-init/user-data # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437 \u0434\u0438\u0441\u043a\u0430 \u0441 \u043c\u0435\u0442\u043a\u043e\u0439 cidata genisoimage \\ -output seed.img \\ -volid cidata -rational-rock -joliet \\ cloud-init/user-data cloud-init/meta-data cloud-init/network-config # \u043f\u043e\u0434 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u043d\u0443\u0436\u0435\u043d \u0441\u0432\u043e\u0439 \u0434\u0438\u0441\u043a cp seed.img seed_01.img cp seed.img seed_02.img \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u044f \u043f\u0435\u0440\u0435\u0434\u0430\u044e \u0432 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 ssh \u043a\u043b\u044e\u0447. \u042d\u0442\u043e\u0442 \u043a\u043b\u044e\u0447 \u0432\u0430\u043c \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043d\u0430 \u0441\u0432\u043e\u0439. \u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b # \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043e\u0431\u0440\u0430\u0437 ubuntu BASE_IMAGE=base.qcow2 BASE_IMAGE_URL=https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img wget $BASE_IMAGE_URL -O $BASE_IMAGE # \u0441\u043e\u0437\u0434\u0430\u0451\u043c \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u044b \u043f\u043e\u0434 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0443 qemu-img create -f qcow2 -b $BASE_IMAGE -F qcow2 01.img 10G qemu-img create -f qcow2 -b $BASE_IMAGE -F qcow2 02.img 10G # \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 qemu-system-x86_64 \\ -machine accel=kvm:tcg \\ -smp cpus=2 \\ -m 512m \\ -drive file=01.img,if=virtio \\ -drive file=seed_01.img,if=virtio,format=raw \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:22001-:22 \\ -device e1000,netdev=net0 \\ -object memory-backend-file,id=mem,size=512m,mem-path=/dev/hugepages,share=on \\ -numa node,memdev=mem -mem-prealloc \\ -chardev socket,id=chr0,path=/var/run/vpp/01.sock \\ -netdev type=vhost-user,id=net1,chardev=chr0 \\ -device virtio-net-pci,mac=00:00:00:00:00:01,netdev=net1 \\ -display none -daemonize qemu-system-x86_64 \\ -machine accel=kvm:tcg \\ -smp cpus=2 \\ -m 512m \\ -drive file=02.img,if=virtio \\ -drive file=seed_01.img,if=virtio,format=raw \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:22002-:22 \\ -device e1000,netdev=net0 \\ -object memory-backend-file,id=mem,size=512m,mem-path=/dev/hugepages,share=on \\ -numa node,memdev=mem -mem-prealloc \\ -chardev socket,id=chr0,path=/var/run/vpp/02.sock \\ -netdev type=vhost-user,id=net1,chardev=chr0 \\ -device virtio-net-pci,mac=00:00:00:00:00:02,netdev=net1 \\ -display none -daemonize \u0422\u0430\u043a \u043c\u044b \u0441\u043e\u0437\u0434\u0430\u0435\u043c 2 \u043c\u0430\u0448\u0438\u043d\u044b \u0441 2 \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430\u043c\u0438. net0 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 SLIRP \u0434\u043b\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043f\u043e ssh (\u043f\u043e\u0440\u0442\u044b 22001 \u0438 22002 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e). \u0412\u0442\u043e\u0440\u043e\u0439 \u0436\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u0431\u0440\u0438\u0434\u0436\u043e\u0432\u0430\u043d \u0441 \u0441\u043e\u0441\u0435\u0434\u043d\u0435\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u043e\u0439. \u0417\u0430\u0434\u0430\u0435\u043c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u041e\u0421 \u043f\u043e ssh. \u0413\u0434\u0435 ssh_key \u0444\u0430\u0439\u043b \u0441 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u043c ssh \u043a\u043b\u044e\u0447\u043e\u043c (\u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 cloud-init \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u0435\u0433\u043e ssh -p 22001 -i ssh_key -o \"StrictHostKeyChecking=no\" -o \"UserKnownHostsFile=/dev/null\" -o \"ConnectTimeout=1\" test@127.0.0.1 ssh -p 22002 -i ssh_key -o \"StrictHostKeyChecking=no\" -o \"UserKnownHostsFile=/dev/null\" -o \"ConnectTimeout=1\" test@127.0.0.1 \u041d\u0430 \u043f\u0435\u0440\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 ip addr add dev ens3 192.168.0.1/24 \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u0439 ip addr add dev ens3 192.168.0.2/24","title":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0435\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d\u044b \u0447\u0435\u0440\u0435\u0437 VPP"},{"location":"notes/qemu_vpp/#vpp","text":"\u0417\u0430\u0434\u0430\u0447\u0430 \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0438 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d qemu \u0432 \u043e\u0434\u043d\u0443 L2 \u0441\u0435\u0442\u044c, \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u044f \u043f\u0440\u043e\u0442\u043e\u043a\u043e\u043b \"vhost-user\" . \u041e\u0441\u043d\u043e\u0432\u043d\u043e\u0435 \u043f\u0440\u0435\u0438\u043c\u0443\u0449\u0435\u0441\u0442\u0432\u043e \u044d\u0442\u043e\u0439 \u0441\u0445\u0435\u043c\u044b \u0437\u0430\u043a\u043b\u044e\u0447\u0430\u0435\u0442\u0441\u044f \u0432 \u0442\u043e\u043c, \u0447\u0442\u043e \u0434\u043b\u044f \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u043f\u0430\u043a\u0435\u0442\u043e\u0432 \u0438\u0437 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0431\u0443\u0434\u0435\u0442 \u043f\u0440\u043e\u0438\u0441\u0445\u043e\u0434\u0438\u0442\u044c \u0431\u0435\u0437 \u043f\u0435\u0440\u0435\u0434\u0430\u0447\u0438 \u0438\u0445 \u0432 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0441\u0442\u0435\u043a \u0445\u043e\u0441\u0442\u043e\u0432\u043e\u0439 \u041e\u0421. \u041a\u0430\u043a \u0438\u0437\u0432\u0435\u0441\u0442\u043d\u043e, \u043f\u0440\u043e\u0438\u0437\u0432\u043e\u0434\u0438\u0442\u0435\u043b\u044c\u043d\u043e\u0441\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u043e\u0433\u043e \u0441\u0442\u0435\u043a\u0430 linux \u043d\u0435 \u0438\u0434\u0435\u0430\u043b\u044c\u043d\u0430, \u043a \u0442\u043e\u043c\u0443 \u0436\u0435 \u0438 \u043f\u0435\u0440\u0435\u043a\u043b\u044e\u0447\u0435\u043d\u0438\u0435 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u0438\u0437 user \u0432 kernel space \u043d\u0435 \u0431\u0435\u0441\u043f\u043b\u0430\u0442\u043d\u043e. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0432 \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0445 \u0441\u043b\u0443\u0447\u0430\u044f\u0445 \u0438\u043c\u0435\u0435\u0442 \u0441\u043c\u044b\u0441\u043b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u044c \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e\u0441\u0442\u044c \u043f\u0435\u0440\u0435\u0434\u0430\u0432\u0430\u0442\u044c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u043f\u0430\u043a\u0435\u0442\u044b \u043e\u0442 \u043e\u0434\u043d\u043e\u0433\u043e \u043f\u0440\u043e\u0446\u0435\u0441\u0441\u0430 \u0434\u0440\u0443\u0433\u043e\u043c\u0443 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e.","title":"\u041e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u0435 \u0432 \u043e\u0434\u043d\u0443 \u0441\u0435\u0442\u044c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d\u044b \u0447\u0435\u0440\u0435\u0437 VPP"},{"location":"notes/qemu_vpp/#_1","text":"\u0412 \u043a\u0430\u0447\u0435\u0441\u0442\u0432\u0435 \u0441\u0442\u0435\u043d\u0434\u0430 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442\u0441\u044f ubuntu 22.04, \u043d\u0430 \u043a\u043e\u0442\u043e\u0440\u043e\u0439 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043b\u0435\u043d\u044b \u043f\u0430\u043a\u0435\u0442\u044b qemu-system-x86 genisoimage curl \u0422\u0430\u043a \u0436\u0435 \u043d\u0430\u043c \u043d\u0430\u0434\u043e \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0438\u0442\u044c VPP . curl -s https://packagecloud.io/install/repositories/fdio/release/script.deb.sh | sudo bash apt-get update apt-get install vpp vpp-plugin-core vpp-plugin-dpdk \u0412\u043d\u0438\u043c\u0430\u043d\u0438\u0435 : \u041d\u0435 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0443\u044e \u0443\u0441\u0442\u0430\u043d\u0430\u0432\u043b\u0438\u0432\u0430\u0442\u044c VPP \u043d\u0430 \u0441\u0432\u043e\u044e \u0440\u0430\u0431\u043e\u0447\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443. \u041f\u043e\u0441\u043b\u0435 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0438 \u0443 \u043c\u0435\u043d\u044f \u043f\u0435\u0440\u0438\u043e\u0434\u0438\u0447\u0435\u0441\u043a\u0438 \u043f\u0430\u0434\u0430\u043b\u0438 \u043f\u0440\u0438\u043b\u043e\u0436\u0435\u043d\u0438\u044f \u0438\u0437 snap \u043f\u0430\u043a\u0435\u0442\u043e\u0432. Coredump \u043f\u043e\u043a\u0430\u0437\u044b\u0432\u0430\u043b \u043e\u0448\u0438\u0431\u043a\u0443 \u0432 \u043d\u0435\u0434\u0440\u0430\u0445 libc, \u0445\u043e\u0442\u044f VPP \u0435\u0433\u043e \u0432\u0435\u0440\u0441\u0438\u044e \u043d\u0435 \u043c\u0435\u043d\u044f\u043b\u043e. \u041a\u0430\u043a \u0431\u044b\u043b\u043e \u0442\u043e \u043d\u0438 \u0431\u044b\u043b\u043e, \u043a\u0443\u0434\u0430 \u0431\u0435\u0437\u043e\u043f\u0430\u0441\u043d\u0435\u0435 \u043f\u043e\u0434\u043e\u0431\u043d\u044b\u0435 \u0442\u0435\u0441\u0442\u044b \u043f\u0440\u043e\u0432\u043e\u0434\u0438\u0442\u044c \u043d\u0430 \u043e\u0442\u0434\u0435\u043b\u044c\u043d\u044b\u0445 \u0441\u0442\u0435\u043d\u0434\u0430\u0445. \u0414\u0435\u0444\u043e\u043b\u0442\u043d\u044b\u0435 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 vpp \u043f\u043e\u0434\u0440\u0430\u0437\u0443\u043c\u0435\u0432\u0430\u044e\u0442 \u0441\u043a\u043b\u0430\u0434\u044b\u0432\u0430\u043d\u0438\u0435 \u043b\u043e\u0433\u043e\u0432 \u0432 \u0434\u0438\u0440\u0435\u043a\u0442\u043e\u0440\u0438\u044e /var/log/vpp/ , \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u0449\u0438\u043a \u043a\u043e\u0442\u043e\u0440\u0443\u044e \u043d\u0435 \u0441\u043e\u0437\u0434\u0430\u0435\u0442. \u041f\u043e\u044d\u0442\u043e\u043c\u0443 \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u044d\u0442\u043e \u043f\u043e\u0447\u0438\u043d\u0438\u0442\u044c mkdir /var/log/vpp/ systemctl restart vpp","title":"\u041f\u043e\u0434\u0433\u043e\u0442\u043e\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0440\u0430\u0431\u043e\u0442\u044b"},{"location":"notes/qemu_vpp/#_2","text":"\u0412\u043e\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u043c\u0441\u044f \u0441\u0430\u043c\u043e\u0439 \u043f\u0440\u043e\u0441\u0442\u043e\u0439 \u0441\u0445\u0435\u043c\u043e\u0439 - \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0438\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u044b \u0432 \u0431\u0440\u0438\u0434\u0436. \u042d\u0442\u043e \u043c\u0430\u043a\u0441\u0438\u043c\u0430\u043b\u044c\u043d\u043e \u043f\u0440\u043e\u0441\u0442\u043e\u0435 \u0440\u0435\u0448\u0435\u043d\u0438\u0435, \u0435\u0441\u0442\u0435\u0441\u0442\u0432\u0435\u043d\u043d\u043e \u0441\u0445\u0435\u043c\u0430 \u043e\u0431\u044a\u0435\u0434\u0438\u043d\u0435\u043d\u0438\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d \u0432 \u0440\u0435\u0430\u043b\u044c\u043d\u043e\u043c \u043c\u0438\u0440\u0435 \u0441\u0438\u043b\u044c\u043d\u043e \u0441\u043b\u043e\u0436\u043d\u0435\u0435. \u041d\u043e \u043f\u0440\u0435\u0434\u043c\u0435\u0442\u043e\u043c \u044d\u0442\u043e\u0439 \u0441\u0442\u0430\u0442\u044c\u0438 \u043d\u0435 \u044f\u0432\u043b\u044f\u0435\u0442\u0441\u044f. vppctl create vhost-user socket /var/run/vpp/01.sock server vppctl create vhost-user socket /var/run/vpp/02.sock server \u0423 \u043d\u0430\u0441 \u043f\u043e\u044f\u0432\u0438\u043b\u0438\u0441\u044c 2 \u0441\u0435\u0442\u0435\u0432\u044b\u0445 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430 VirtualEthernet0/0/0 \u0438 VirtualEthernet0/0/1 . \u041e\u0431\u044a\u0435\u0434\u0438\u043d\u044f\u0435\u043c \u0438\u0445 \u0432 \u0431\u0440\u0438\u0434\u0436 vppctl set interface l2 bridge VirtualEthernet0/0/0 1 vppctl set interface l2 bridge VirtualEthernet0/0/1 1 \u0412\u043e\u0437\u043c\u043e\u0436\u043d\u044b\u0435 \u043f\u0440\u043e\u0431\u043b\u0435\u043c\u044b : \u043c\u0430\u043a \u0430\u0434\u0440\u0435\u0441\u0430 \u043d\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u043c \u0441\u0435\u0442\u0435\u0432\u043e\u043c \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 \u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0435 \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 \u043d\u0435 \u0441\u043e\u0432\u043f\u0430\u0434\u0430\u044e\u0442. \u041a\u0430\u0436\u0435\u0442\u0441\u044f \u044d\u0442\u043e \u043d\u0435 \u0444\u0438\u0447\u0430. \u0412 \u044d\u0442\u043e\u043c \u0441\u043b\u0443\u0447\u0430\u0435 \u043d\u0430\u0434\u043e \u043f\u043e\u0432\u0435\u0441\u0438\u0442\u044c \u043d\u0430 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0439 \u0441\u0435\u0442\u0435\u0432\u043e\u0439 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u043c\u0430\u043a \u0430\u0434\u0440\u0435\u0441 \u0438\u0437 \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421 (\u0438\u043b\u0438 \u043d\u0430\u043e\u0431\u043e\u0440\u043e\u0442).","title":"\u041a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0438\u0440\u0443\u0435\u043c \u0441\u0435\u0442\u044c \u0434\u043b\u044f \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0445 \u043c\u0430\u0448\u0438\u043d"},{"location":"notes/qemu_vpp/#_3","text":"vhost-user \u0442\u0440\u0435\u0431\u0443\u044e\u0442 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f hugetbl \u0438 shared memory. VPP \u0431\u0443\u0434\u0435\u0442 \u043d\u0430\u043f\u0440\u044f\u043c\u0443\u044e \u0445\u043e\u0434\u0438\u0442\u044c \u0432 \u043f\u0430\u043c\u044f\u0442\u044c \u0433\u043e\u0441\u0442\u0435\u0432\u043e\u0439 \u041e\u0421. VPP \u043f\u0440\u0438 \u0443\u0441\u0442\u0430\u043d\u043e\u0432\u043a\u0435 \u0437\u0430\u0434\u0430\u0435\u0442 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b \u044f\u0434\u0440\u0430, \u043d\u0430 \u043d\u0438\u0445 \u043d\u0430\u0434\u043e \u043a\u0440\u0438\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u0432\u0437\u0433\u043b\u044f\u043d\u0443\u0442\u044c \u0438 \u0432\u043e\u0437\u043c\u043e\u0436\u043d\u043e \u0443\u0432\u0435\u043b\u0438\u0447\u0438\u0442\u044c \u043d\u0435\u043a\u043e\u0442\u043e\u0440\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f. \u041d\u0430\u043f\u0440\u0438\u043c\u0435\u0440 \u0442\u0430\u043a cat /etc/sysctl.d/80-vpp.conf # Number of 2MB hugepages desired vm.nr_hugepages=10240 # Must be greater than or equal to (2 * vm.nr_hugepages). vm.max_map_count=20480 # All groups allowed to access hugepages vm.hugetlb_shm_group=0 # Shared Memory Max must be greater or equal to the total size of hugepages. # For 2MB pages, TotalHugepageSize = vm.nr_hugepages * 2 * 1024 * 1024 # If the existing kernel.shmmax setting (cat /proc/sys/kernel/shmmax) # is greater than the calculated TotalHugepageSize then set this parameter # to current shmmax value. kernel.shmmax=21474836480 \u043f\u043e\u0441\u043b\u0435 \u0447\u0435\u0433\u043e \u043f\u0440\u0438\u043c\u0435\u043d\u0438\u043c \u044d\u0442\u0438 \u043d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0438 sysctl -p /etc/sysctl.d/80-vpp.conf vm.nr_hugepages = 10240 vm.max_map_count = 20480 vm.hugetlb_shm_group = 0 kernel.shmmax = 21474836480","title":"\u041d\u0430\u0441\u0442\u0440\u043e\u0439\u043a\u0430 \u043f\u0430\u043c\u044f\u0442\u0438 \u043d\u0430 \u0445\u043e\u0441\u0442\u0435"},{"location":"notes/qemu_vpp/#cloud-init","text":"\u0412 \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b\u044b \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 cloud-init. # \u0441\u043e\u0437\u0434\u0430\u0435\u043c ssh \u043a\u043b\u044e\u0447\u0438 \u0434\u043b\u044f \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u0432 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 ssh-keygen -t ed25519 -C \"test@compute\" # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u0444\u0430\u0439\u043b\u044b \u0441 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0435\u0439 cloud-init mkdir cloud-init touch cloud-init/meta-data touch cloud-init/network-config echo \"#cloud-config user: test password: test chpasswd: expire: False ssh_pwauth: True ssh_authorized_keys: - ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIC2mkI/No5xj3fFcfvq/y3b84p8nODFbQf5sETNHwa8W test@compute \" > cloud-init/user-data # \u0441\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437 \u0434\u0438\u0441\u043a\u0430 \u0441 \u043c\u0435\u0442\u043a\u043e\u0439 cidata genisoimage \\ -output seed.img \\ -volid cidata -rational-rock -joliet \\ cloud-init/user-data cloud-init/meta-data cloud-init/network-config # \u043f\u043e\u0434 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u0443\u044e \u043c\u0430\u0448\u0438\u043d\u0443 \u043d\u0443\u0436\u0435\u043d \u0441\u0432\u043e\u0439 \u0434\u0438\u0441\u043a cp seed.img seed_01.img cp seed.img seed_02.img \u041e\u0431\u0440\u0430\u0442\u0438\u0442\u0435 \u0432\u043d\u0438\u043c\u0430\u043d\u0438\u0435, \u0447\u0442\u043e \u044f \u043f\u0435\u0440\u0435\u0434\u0430\u044e \u0432 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043f\u0443\u0431\u043b\u0438\u0447\u043d\u044b\u0439 ssh \u043a\u043b\u044e\u0447. \u042d\u0442\u043e\u0442 \u043a\u043b\u044e\u0447 \u0432\u0430\u043c \u0441\u043b\u0435\u0434\u0443\u0435\u0442 \u043f\u043e\u043c\u0435\u043d\u044f\u0442\u044c \u043d\u0430 \u0441\u0432\u043e\u0439.","title":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u043e\u0431\u0440\u0430\u0437\u044b cloud-init"},{"location":"notes/qemu_vpp/#_4","text":"# \u0441\u043a\u0430\u0447\u0438\u0432\u0430\u0435\u043c \u0431\u0430\u0437\u043e\u0432\u044b\u0439 \u043e\u0431\u0440\u0430\u0437 ubuntu BASE_IMAGE=base.qcow2 BASE_IMAGE_URL=https://cloud-images.ubuntu.com/jammy/current/jammy-server-cloudimg-amd64.img wget $BASE_IMAGE_URL -O $BASE_IMAGE # \u0441\u043e\u0437\u0434\u0430\u0451\u043c \u0441\u043d\u0430\u043f\u0448\u043e\u0442\u044b \u043f\u043e\u0434 \u043a\u0430\u0436\u0434\u0443\u044e \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0443 qemu-img create -f qcow2 -b $BASE_IMAGE -F qcow2 01.img 10G qemu-img create -f qcow2 -b $BASE_IMAGE -F qcow2 02.img 10G # \u0437\u0430\u043f\u0443\u0441\u043a\u0430\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u043a\u0438 qemu-system-x86_64 \\ -machine accel=kvm:tcg \\ -smp cpus=2 \\ -m 512m \\ -drive file=01.img,if=virtio \\ -drive file=seed_01.img,if=virtio,format=raw \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:22001-:22 \\ -device e1000,netdev=net0 \\ -object memory-backend-file,id=mem,size=512m,mem-path=/dev/hugepages,share=on \\ -numa node,memdev=mem -mem-prealloc \\ -chardev socket,id=chr0,path=/var/run/vpp/01.sock \\ -netdev type=vhost-user,id=net1,chardev=chr0 \\ -device virtio-net-pci,mac=00:00:00:00:00:01,netdev=net1 \\ -display none -daemonize qemu-system-x86_64 \\ -machine accel=kvm:tcg \\ -smp cpus=2 \\ -m 512m \\ -drive file=02.img,if=virtio \\ -drive file=seed_01.img,if=virtio,format=raw \\ -netdev user,id=net0,ipv6=off,restrict=off,net=10.0.2.0/24,hostfwd=tcp:127.0.0.1:22002-:22 \\ -device e1000,netdev=net0 \\ -object memory-backend-file,id=mem,size=512m,mem-path=/dev/hugepages,share=on \\ -numa node,memdev=mem -mem-prealloc \\ -chardev socket,id=chr0,path=/var/run/vpp/02.sock \\ -netdev type=vhost-user,id=net1,chardev=chr0 \\ -device virtio-net-pci,mac=00:00:00:00:00:02,netdev=net1 \\ -display none -daemonize \u0422\u0430\u043a \u043c\u044b \u0441\u043e\u0437\u0434\u0430\u0435\u043c 2 \u043c\u0430\u0448\u0438\u043d\u044b \u0441 2 \u0441\u0435\u0442\u0435\u0432\u044b\u043c\u0438 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441\u0430\u043c\u0438. net0 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u0443\u0435\u0442 SLIRP \u0434\u043b\u044f \u043e\u0440\u0433\u0430\u043d\u0438\u0437\u0430\u0446\u0438\u0438 \u0434\u043e\u0441\u0442\u0443\u043f\u0430 \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b \u043f\u043e ssh (\u043f\u043e\u0440\u0442\u044b 22001 \u0438 22002 \u0441\u043e\u043e\u0442\u0432\u0435\u0442\u0441\u0442\u0432\u0435\u043d\u043d\u043e). \u0412\u0442\u043e\u0440\u043e\u0439 \u0436\u0435 \u0438\u043d\u0442\u0435\u0440\u0444\u0435\u0439\u0441 \u0431\u0443\u0434\u0435\u0442 \u0437\u0430\u0431\u0440\u0438\u0434\u0436\u043e\u0432\u0430\u043d \u0441 \u0441\u043e\u0441\u0435\u0434\u043d\u0435\u0439 \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u043e\u0439. \u0417\u0430\u0434\u0430\u0435\u043c \u0441\u0435\u0442\u0435\u0432\u044b\u0435 \u0430\u0434\u0440\u0435\u0441\u0430. \u0414\u043b\u044f \u044d\u0442\u043e\u0433\u043e \u043c\u044b \u043c\u043e\u0436\u0435\u043c \u043f\u043e\u0434\u043a\u043b\u044e\u0447\u0438\u0442\u044c\u0441\u044f \u043d\u0430 \u0433\u043e\u0441\u0442\u0435\u0432\u044b\u0435 \u041e\u0421 \u043f\u043e ssh. \u0413\u0434\u0435 ssh_key \u0444\u0430\u0439\u043b \u0441 \u043f\u0440\u0438\u0432\u0430\u0442\u043d\u044b\u043c ssh \u043a\u043b\u044e\u0447\u043e\u043c (\u0432 \u043a\u043e\u043d\u0444\u0438\u0433\u0443\u0440\u0430\u0446\u0438\u0438 cloud-init \u043c\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043b\u0438 \u0435\u0433\u043e ssh -p 22001 -i ssh_key -o \"StrictHostKeyChecking=no\" -o \"UserKnownHostsFile=/dev/null\" -o \"ConnectTimeout=1\" test@127.0.0.1 ssh -p 22002 -i ssh_key -o \"StrictHostKeyChecking=no\" -o \"UserKnownHostsFile=/dev/null\" -o \"ConnectTimeout=1\" test@127.0.0.1 \u041d\u0430 \u043f\u0435\u0440\u0432\u043e\u0439 \u043c\u0430\u0448\u0438\u043d\u0435 ip addr add dev ens3 192.168.0.1/24 \u043d\u0430 \u0432\u0442\u043e\u0440\u043e\u0439 ip addr add dev ens3 192.168.0.2/24","title":"\u0421\u043e\u0437\u0434\u0430\u0435\u043c \u0432\u0438\u0440\u0442\u0443\u0430\u043b\u044c\u043d\u044b\u0435 \u043c\u0430\u0448\u0438\u043d\u044b"}]}